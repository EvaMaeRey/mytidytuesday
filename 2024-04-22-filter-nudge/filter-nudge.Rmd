---
title: "another experiment"
author: "Evangeline Reynolds"
date: "`r Sys.Date()`"
output: 
  html_document:
    toc: TRUE
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
options(tidyverse.quiet = TRUE)
```




## Intro Thoughts


## Status Quo

```{r cars}
library(tidyverse)

nudge_x = -1
nudge_y = 12
pad_x = 0
pad_y = 0

ggplot(cars) + 
  aes(x = speed, y = dist) + 
  geom_point() + 
  geom_text(data = . %>% slice(15),
            label = "my insight",
            nudge_x = nudge_x,
            nudge_y = nudge_y, 
            vjust = -sign(nudge_y),
            hjust = -sign(nudge_x),
            ) +
  geom_segment(data = . %>% slice(15),
               aes(xend = after_stat(x) + nudge_x + pad_x,
                   yend = after_stat(y) + nudge_y + pad_y))
```


```{r}
add_callout <- function(data = data, label = "Hello World!", nudge_x = 0, nudge_y = 0, prop_pad_x = .1, prop_pad_y = .1, curvature = 0, ... ){

  
  list(
    geom_text(data = data,
            label = label,
            nudge_x = nudge_x,
            nudge_y = nudge_y, 
            vjust = -sign(nudge_y) == 1 ,
            hjust = -sign(nudge_x) == 1,
            ...
            ),
    geom_curve(data = data,
               aes(xend = after_stat(x) + nudge_x - prop_pad_x*nudge_x,
                   yend = after_stat(y) + nudge_y - prop_pad_y*nudge_y,
                   # x = after_stat(x) - pad_x,
                   # y = after_stat(y) - pad_y
                   ),
               curvature = curvature),
    ...
  )
    
}


ggplot(cars) +
  aes(speed, dist) + 
  geom_point() + 
  add_callout(data = . %>% slice(3), 
              nudge_y = -10, 
              nudge_x = 1)


gapminder::gapminder %>% 
  filter(year == 2002) %>% 
  ggplot() + 
  aes(x = gdpPercap, y = lifeExp) + 
  geom_point() + 
  add_callout(data = . %>% 
                filter(country == "Japan"),
              nudge_x = 1000,
              nudge_y = 2,
              label = "Japan" 
              ) + 
  add_callout(data = . %>% 
                filter(country == "Australia"),
              nudge_x = 1500,
              nudge_y = -10,
              label = "Here we have Australia",
              curvature = -.2)



```

## Experiment

```{r}

```



## Closing remarks, Other Relevant Work, Caveats
