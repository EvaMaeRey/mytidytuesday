---
title: "another experiment"
author: "Evangeline Reynolds"
date: "`r Sys.Date()`"
output: 
  html_document:
    toc: TRUE
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
options(tidyverse.quiet = TRUE)
```




## Intro Thoughts


## Status Quo

```{r}
`%||%` <- function (a, b) {
    if (!is.null(a)) 
        a
    else b
}

library(statexpress)
library(tidyverse)
x <- function(x){aes(x = {{x}})}
y <- function(y){aes(y = {{y}})}
size <- function(size){aes(size = {{size}})}
color <- function(color){aes(fill = {{color}}, color = {{color}})}
layer_point <- function(...){qlayer(geom = qproto_update(GeomPoint, aes(shape = 21)), ...)}

layer_point <- function(...){qlayer(geom = qproto_update(GeomPoint, aes(shape = 21), 
                                                         required_aes = c()),
                                    stat = qstat(function(data, scales){if(is.null(data$x)){data$x <- 0}; if(is.null(data$y)){data$y <- 0}; data}), ...)}

theme_chart_bar <- function(){theme(panel.grid.minor = element_blank(), panel.grid.major.x = element_blank(),
                                    axis.ticks.x = element_blank())}

layer_bar <- function(...){list(geom_bar(...), theme_chart_bar(), scale_y_continuous(expand = c(0, .3)))}
data <- function(data){ggplot(data) + ggchalkboard:::theme_whiteboard()}
layer_jitter <- geom_jitter

layer_heat <- function(...){list(
  qlayer(geom = GeomTile, 
         stat = qproto_update(StatSum, aes(fill = after_stat(n), size = NULL)), ...),
  scale_fill_gradientn(colors = c("blue", "white", "yellow", "orange", "red")),
  theme(panel.grid.minor = element_line(color = "darkgrey")))
}

encode <- function(color, ...){
  aes(color = {{color}}, fill = {{color}}, ...) 
}

map <- encode

layer_pie <- function(...){list(
  
)
  
}

data(cars) + 
  # x(speed) + 
  # y(dist) + 
  layer_point() + 
  color(speed)

data(palmerpenguins::penguins) + 
  x(island) + 
  layer_bar() + 
  color(species)

ggplot(palmerpenguins::penguins) + 
  # ggchalkboard:::theme_whiteboard() +
  x(island) + 
  y(species) +
  layer_jitter() + 
  layer_heat(alpha = .7) # does not play nice with size yet

  
data(palmerpenguins::penguins) + 
  x(island) + 
  y(species) +
  layer_jitter() +
  size(body_mass_g) + 
  guides(size = "none")


data(palmerpenguins::penguins) + 
  encode(x = island, color = species) + 
  layer_bar()


```

## Experiment

```{r}

```



## Closing remarks, Other Relevant Work, Caveats
