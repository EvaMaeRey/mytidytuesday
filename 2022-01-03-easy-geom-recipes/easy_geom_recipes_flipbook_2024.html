<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Easy Geom Recipes (Exploded version)</title>
    <meta charset="utf-8" />
    <meta name="author" content="Gina Reynold, Morgan Brown" />
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/hygge.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/ninjutsu.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">



class: inverse, middle
background-image: url(https://images.unsplash.com/photo-1592173376801-185310a68dea?ixlib=rb-1.2.1&amp;ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&amp;auto=format&amp;fit=crop&amp;w=1286&amp;q=80)
background-size: cover



# Easy geom_*() recipes

###Gina Reynolds and Morgan Brown

&lt;br&gt;
&lt;br&gt;
&lt;br&gt;




&lt;style type="text/css"&gt;
.remark-code{line-height: 1.5; font-size: 90%}

@media print {
  .has-continuation {
    display: block;
  }
}

code.r.hljs.remark-code{
  position: relative;
  overflow-x: hidden;
}


code.r.hljs.remark-code:hover{
  overflow-x:visible;
  width: 500px;
  border-style: solid;
}
&lt;/style&gt;

---


### Using ggplot2 has been described as writing 'graphical poems'.

--

&lt;!-- and a system that lets us 'speak our plot into existence'.  --&gt;
### But we may feel at a loss for words when functions we'd like to have don't exist.  The ggplot2 extension system allows us to build new 'vocabulary' for fluent expression.  

--

### An exciting extension mechanism is inheriting from existing Geoms.  Particularly important to statisticians and mathematicians is writing new geom_* functions that perform and visualize calculations.  

---

### To get your feet wet in this world and give you a taste of patterns for geom extension, we provide three *introductory* examples of the geom_ functions that inherit from *existing* geoms (GeomPoint, GeomText, GeomSegment, etc) along with practice exercises.  

--

### (You may only be familiar with the user-facing geom_point(), geom_text(), geom_segment() layer functions that use these more primitive objects under the hood, and that's okay.) 

---

### With your new geom_ function, calculation is done under the hood by the ggplot2 system; with these geom_* functions, you can write graphical poems with consice new language you've tailored for yourself! 

---

### This tutorial is intended for individuals who already have a working knowledge of the grammar of ggplot2, but may like to build a richer vocabulary for themselves. 

--

### Grab an .Rmd worksheet version [here](https://raw.githubusercontent.com/EvaMaeRey/mytidytuesday/master/2022-01-03-easy-geom-recipes/easy_geom_recipes_2024.Rmd).

### or you can browse the rendered version of that [here](https://evamaerey.github.io/mytidytuesday/2022-01-03-easy-geom-recipes/easy_geom_recipes_2024.html).

---

# Preview

Our recipes will take form:

--

**Step 0. Get the job done with 'base' ggplot2.**  
--
It's a good idea to clarify what needs to happen without getting into the extension architecture

--

**Step 1. Write a computation function.** 
--
Wrap the necessary computation into a function that your target geom_*() function will perform.

--

**Step 2. Define a ggproto object.** 
--
ggproto objects allow your extension  to work together with base ggplot2 functions!  You'll use the computation function from step 1 to help define it.

--

**Step 3. Write your geom function!** 
--
You're ready to write your function.  You will incorporate the ggproto from step 2.  

--

**Step 4. Test/Enjoy!** 
--
Take your new geom for a spin! Check out group-wise computation behavior!





---
class: inverse, middle, center

# Recipe #1

--

##`geom_point_xy_medians()`

--

- This will be a point at the median of x and y


---
class: inverse, middle, center

## Step 0: use base ggplot2 to get the job done

---


count: false
 

.panel1-penguins-auto[

```r
*library(tidyverse)

NA
```
]
 
.panel2-penguins-auto[

```
[1] NA
```
]

---
count: false
 

.panel1-penguins-auto[

```r
library(tidyverse)
*library(palmerpenguins)

NA
```
]
 
.panel2-penguins-auto[

```
[1] NA
```
]

---
count: false
 

.panel1-penguins-auto[

```r
library(tidyverse)
library(palmerpenguins)

*penguins &lt;- remove_missing(penguins)

NA
```
]
 
.panel2-penguins-auto[

```
[1] NA
```
]

---
count: false
 

.panel1-penguins-auto[

```r
library(tidyverse)
library(palmerpenguins)

penguins &lt;- remove_missing(penguins)

*penguins

NA
```
]
 
.panel2-penguins-auto[

```
# A tibble: 333 × 8
   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex     year
   &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt; &lt;fct&gt;  &lt;int&gt;
 1 Adelie  Torgersen           39.1          18.7               181        3750 male    2007
 2 Adelie  Torgersen           39.5          17.4               186        3800 female  2007
 3 Adelie  Torgersen           40.3          18                 195        3250 female  2007
 4 Adelie  Torgersen           36.7          19.3               193        3450 female  2007
 5 Adelie  Torgersen           39.3          20.6               190        3650 male    2007
 6 Adelie  Torgersen           38.9          17.8               181        3625 female  2007
 7 Adelie  Torgersen           39.2          19.6               195        4675 male    2007
 8 Adelie  Torgersen           41.1          17.6               182        3200 female  2007
 9 Adelie  Torgersen           38.6          21.2               191        3800 male    2007
10 Adelie  Torgersen           34.6          21.1               198        4400 male    2007
11 Adelie  Torgersen           36.6          17.8               185        3700 female  2007
12 Adelie  Torgersen           38.7          19                 195        3450 female  2007
13 Adelie  Torgersen           42.5          20.7               197        4500 male    2007
14 Adelie  Torgersen           34.4          18.4               184        3325 female  2007
15 Adelie  Torgersen           46            21.5               194        4200 male    2007
16 Adelie  Biscoe              37.8          18.3               174        3400 female  2007
17 Adelie  Biscoe              37.7          18.7               180        3600 male    2007
18 Adelie  Biscoe              35.9          19.2               189        3800 female  2007
19 Adelie  Biscoe              38.2          18.1               185        3950 male    2007
20 Adelie  Biscoe              38.8          17.2               180        3800 male    2007
21 Adelie  Biscoe              35.3          18.9               187        3800 female  2007
22 Adelie  Biscoe              40.6          18.6               183        3550 male    2007
23 Adelie  Biscoe              40.5          17.9               187        3200 female  2007
24 Adelie  Biscoe              37.9          18.6               172        3150 female  2007
25 Adelie  Biscoe              40.5          18.9               180        3950 male    2007
26 Adelie  Dream               39.5          16.7               178        3250 female  2007
27 Adelie  Dream               37.2          18.1               178        3900 male    2007
28 Adelie  Dream               39.5          17.8               188        3300 female  2007
29 Adelie  Dream               40.9          18.9               184        3900 male    2007
30 Adelie  Dream               36.4          17                 195        3325 female  2007
31 Adelie  Dream               39.2          21.1               196        4150 male    2007
32 Adelie  Dream               38.8          20                 190        3950 male    2007
33 Adelie  Dream               42.2          18.5               180        3550 female  2007
34 Adelie  Dream               37.6          19.3               181        3300 female  2007
35 Adelie  Dream               39.8          19.1               184        4650 male    2007
36 Adelie  Dream               36.5          18                 182        3150 female  2007
37 Adelie  Dream               40.8          18.4               195        3900 male    2007
38 Adelie  Dream               36            18.5               186        3100 female  2007
39 Adelie  Dream               44.1          19.7               196        4400 male    2007
40 Adelie  Dream               37            16.9               185        3000 female  2007
41 Adelie  Dream               39.6          18.8               190        4600 male    2007
42 Adelie  Dream               41.1          19                 182        3425 male    2007
43 Adelie  Dream               36            17.9               190        3450 female  2007
44 Adelie  Dream               42.3          21.2               191        4150 male    2007
45 Adelie  Biscoe              39.6          17.7               186        3500 female  2008
46 Adelie  Biscoe              40.1          18.9               188        4300 male    2008
47 Adelie  Biscoe              35            17.9               190        3450 female  2008
48 Adelie  Biscoe              42            19.5               200        4050 male    2008
49 Adelie  Biscoe              34.5          18.1               187        2900 female  2008
50 Adelie  Biscoe              41.4          18.6               191        3700 male    2008
51 Adelie  Biscoe              39            17.5               186        3550 female  2008
52 Adelie  Biscoe              40.6          18.8               193        3800 male    2008
53 Adelie  Biscoe              36.5          16.6               181        2850 female  2008
54 Adelie  Biscoe              37.6          19.1               194        3750 male    2008
55 Adelie  Biscoe              35.7          16.9               185        3150 female  2008
# ℹ 278 more rows
```

```
[1] NA
```
]

---
count: false
 

.panel1-penguins-auto[

```r
library(tidyverse)
library(palmerpenguins)

penguins &lt;- remove_missing(penguins)

penguins %&gt;%
* summarize(bill_length_mm_median = median(bill_length_mm),
*           bill_depth_mm_median = median(bill_depth_mm))

NA
```
]
 
.panel2-penguins-auto[

```
# A tibble: 1 × 2
  bill_length_mm_median bill_depth_mm_median
                  &lt;dbl&gt;                &lt;dbl&gt;
1                  44.5                 17.3
```

```
[1] NA
```
]

---
count: false
 

.panel1-penguins-auto[

```r
library(tidyverse)
library(palmerpenguins)

penguins &lt;- remove_missing(penguins)

penguins %&gt;%
  summarize(bill_length_mm_median = median(bill_length_mm),
            bill_depth_mm_median = median(bill_depth_mm)) -&gt;
*penguins_medians

NA
```
]
 
.panel2-penguins-auto[

```
[1] NA
```
]

---
count: false
 

.panel1-penguins-auto[

```r
library(tidyverse)
library(palmerpenguins)

penguins &lt;- remove_missing(penguins)

penguins %&gt;%
  summarize(bill_length_mm_median = median(bill_length_mm),
            bill_depth_mm_median = median(bill_depth_mm)) -&gt;
penguins_medians

*penguins

NA
```
]
 
.panel2-penguins-auto[

```
# A tibble: 333 × 8
   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex     year
   &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt; &lt;fct&gt;  &lt;int&gt;
 1 Adelie  Torgersen           39.1          18.7               181        3750 male    2007
 2 Adelie  Torgersen           39.5          17.4               186        3800 female  2007
 3 Adelie  Torgersen           40.3          18                 195        3250 female  2007
 4 Adelie  Torgersen           36.7          19.3               193        3450 female  2007
 5 Adelie  Torgersen           39.3          20.6               190        3650 male    2007
 6 Adelie  Torgersen           38.9          17.8               181        3625 female  2007
 7 Adelie  Torgersen           39.2          19.6               195        4675 male    2007
 8 Adelie  Torgersen           41.1          17.6               182        3200 female  2007
 9 Adelie  Torgersen           38.6          21.2               191        3800 male    2007
10 Adelie  Torgersen           34.6          21.1               198        4400 male    2007
11 Adelie  Torgersen           36.6          17.8               185        3700 female  2007
12 Adelie  Torgersen           38.7          19                 195        3450 female  2007
13 Adelie  Torgersen           42.5          20.7               197        4500 male    2007
14 Adelie  Torgersen           34.4          18.4               184        3325 female  2007
15 Adelie  Torgersen           46            21.5               194        4200 male    2007
16 Adelie  Biscoe              37.8          18.3               174        3400 female  2007
17 Adelie  Biscoe              37.7          18.7               180        3600 male    2007
18 Adelie  Biscoe              35.9          19.2               189        3800 female  2007
19 Adelie  Biscoe              38.2          18.1               185        3950 male    2007
20 Adelie  Biscoe              38.8          17.2               180        3800 male    2007
21 Adelie  Biscoe              35.3          18.9               187        3800 female  2007
22 Adelie  Biscoe              40.6          18.6               183        3550 male    2007
23 Adelie  Biscoe              40.5          17.9               187        3200 female  2007
24 Adelie  Biscoe              37.9          18.6               172        3150 female  2007
25 Adelie  Biscoe              40.5          18.9               180        3950 male    2007
26 Adelie  Dream               39.5          16.7               178        3250 female  2007
27 Adelie  Dream               37.2          18.1               178        3900 male    2007
28 Adelie  Dream               39.5          17.8               188        3300 female  2007
29 Adelie  Dream               40.9          18.9               184        3900 male    2007
30 Adelie  Dream               36.4          17                 195        3325 female  2007
31 Adelie  Dream               39.2          21.1               196        4150 male    2007
32 Adelie  Dream               38.8          20                 190        3950 male    2007
33 Adelie  Dream               42.2          18.5               180        3550 female  2007
34 Adelie  Dream               37.6          19.3               181        3300 female  2007
35 Adelie  Dream               39.8          19.1               184        4650 male    2007
36 Adelie  Dream               36.5          18                 182        3150 female  2007
37 Adelie  Dream               40.8          18.4               195        3900 male    2007
38 Adelie  Dream               36            18.5               186        3100 female  2007
39 Adelie  Dream               44.1          19.7               196        4400 male    2007
40 Adelie  Dream               37            16.9               185        3000 female  2007
41 Adelie  Dream               39.6          18.8               190        4600 male    2007
42 Adelie  Dream               41.1          19                 182        3425 male    2007
43 Adelie  Dream               36            17.9               190        3450 female  2007
44 Adelie  Dream               42.3          21.2               191        4150 male    2007
45 Adelie  Biscoe              39.6          17.7               186        3500 female  2008
46 Adelie  Biscoe              40.1          18.9               188        4300 male    2008
47 Adelie  Biscoe              35            17.9               190        3450 female  2008
48 Adelie  Biscoe              42            19.5               200        4050 male    2008
49 Adelie  Biscoe              34.5          18.1               187        2900 female  2008
50 Adelie  Biscoe              41.4          18.6               191        3700 male    2008
51 Adelie  Biscoe              39            17.5               186        3550 female  2008
52 Adelie  Biscoe              40.6          18.8               193        3800 male    2008
53 Adelie  Biscoe              36.5          16.6               181        2850 female  2008
54 Adelie  Biscoe              37.6          19.1               194        3750 male    2008
55 Adelie  Biscoe              35.7          16.9               185        3150 female  2008
# ℹ 278 more rows
```

```
[1] NA
```
]

---
count: false
 

.panel1-penguins-auto[

```r
library(tidyverse)
library(palmerpenguins)

penguins &lt;- remove_missing(penguins)

penguins %&gt;%
  summarize(bill_length_mm_median = median(bill_length_mm),
            bill_depth_mm_median = median(bill_depth_mm)) -&gt;
penguins_medians

penguins %&gt;%
* ggplot()

NA
```
]
 
.panel2-penguins-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/penguins_auto_08_output-1.png)&lt;!-- --&gt;

```
[1] NA
```
]

---
count: false
 

.panel1-penguins-auto[

```r
library(tidyverse)
library(palmerpenguins)

penguins &lt;- remove_missing(penguins)

penguins %&gt;%
  summarize(bill_length_mm_median = median(bill_length_mm),
            bill_depth_mm_median = median(bill_depth_mm)) -&gt;
penguins_medians

penguins %&gt;%
  ggplot() +
* aes(x = bill_depth_mm)

NA
```
]
 
.panel2-penguins-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/penguins_auto_09_output-1.png)&lt;!-- --&gt;

```
[1] NA
```
]

---
count: false
 

.panel1-penguins-auto[

```r
library(tidyverse)
library(palmerpenguins)

penguins &lt;- remove_missing(penguins)

penguins %&gt;%
  summarize(bill_length_mm_median = median(bill_length_mm),
            bill_depth_mm_median = median(bill_depth_mm)) -&gt;
penguins_medians

penguins %&gt;%
  ggplot() +
  aes(x = bill_depth_mm) +
* aes(y = bill_length_mm)

NA
```
]
 
.panel2-penguins-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/penguins_auto_10_output-1.png)&lt;!-- --&gt;

```
[1] NA
```
]

---
count: false
 

.panel1-penguins-auto[

```r
library(tidyverse)
library(palmerpenguins)

penguins &lt;- remove_missing(penguins)

penguins %&gt;%
  summarize(bill_length_mm_median = median(bill_length_mm),
            bill_depth_mm_median = median(bill_depth_mm)) -&gt;
penguins_medians

penguins %&gt;%
  ggplot() +
  aes(x = bill_depth_mm) +
  aes(y = bill_length_mm) +
* geom_point()

NA
```
]
 
.panel2-penguins-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/penguins_auto_11_output-1.png)&lt;!-- --&gt;

```
[1] NA
```
]

---
count: false
 

.panel1-penguins-auto[

```r
library(tidyverse)
library(palmerpenguins)

penguins &lt;- remove_missing(penguins)

penguins %&gt;%
  summarize(bill_length_mm_median = median(bill_length_mm),
            bill_depth_mm_median = median(bill_depth_mm)) -&gt;
penguins_medians

penguins %&gt;%
  ggplot() +
  aes(x = bill_depth_mm) +
  aes(y = bill_length_mm) +
  geom_point() +
* geom_point(data = penguins_medians,
*   color = "red", size = 4,
*            aes(x = bill_depth_mm_median,
*                y = bill_length_mm_median))

NA
```
]
 
.panel2-penguins-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/penguins_auto_12_output-1.png)&lt;!-- --&gt;

```
[1] NA
```
]

&lt;style&gt;
.panel1-penguins-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-penguins-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-penguins-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;






---
class: inverse, middle, center

## Step 1: computation

--

- define computation that ggplot2 should do for you, before plotting
  - here it's computing a variable with labels for each observation
- test that functionality!

---


count: false
 

.panel1-compute_group_xy_medians-auto[

```r
*compute_group_xy_medians &lt;- function(data,
*                                    scales){
* data %&gt;%
*   summarize(x = median(x),
*             y = median(y))
*} 

compute_group_xy_medians
```
]
 
.panel2-compute_group_xy_medians-auto[

```
function(data,  #&lt;&lt;
                                     scales){  #&lt;&lt;
  data %&gt;%  #&lt;&lt;
    summarize(x = median(x),  #&lt;&lt;
              y = median(y))  #&lt;&lt;
}
&lt;environment: 0x7fc1f190f6d0&gt;
```
]

---
count: false
 

.panel1-compute_group_xy_medians-auto[

```r
compute_group_xy_medians &lt;- function(data,
                                     scales){
  data %&gt;%
    summarize(x = median(x),
              y = median(y))
}

*penguins

compute_group_xy_medians
```
]
 
.panel2-compute_group_xy_medians-auto[

```
# A tibble: 333 × 8
   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex     year
   &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt; &lt;fct&gt;  &lt;int&gt;
 1 Adelie  Torgersen           39.1          18.7               181        3750 male    2007
 2 Adelie  Torgersen           39.5          17.4               186        3800 female  2007
 3 Adelie  Torgersen           40.3          18                 195        3250 female  2007
 4 Adelie  Torgersen           36.7          19.3               193        3450 female  2007
 5 Adelie  Torgersen           39.3          20.6               190        3650 male    2007
 6 Adelie  Torgersen           38.9          17.8               181        3625 female  2007
 7 Adelie  Torgersen           39.2          19.6               195        4675 male    2007
 8 Adelie  Torgersen           41.1          17.6               182        3200 female  2007
 9 Adelie  Torgersen           38.6          21.2               191        3800 male    2007
10 Adelie  Torgersen           34.6          21.1               198        4400 male    2007
11 Adelie  Torgersen           36.6          17.8               185        3700 female  2007
12 Adelie  Torgersen           38.7          19                 195        3450 female  2007
13 Adelie  Torgersen           42.5          20.7               197        4500 male    2007
14 Adelie  Torgersen           34.4          18.4               184        3325 female  2007
15 Adelie  Torgersen           46            21.5               194        4200 male    2007
16 Adelie  Biscoe              37.8          18.3               174        3400 female  2007
17 Adelie  Biscoe              37.7          18.7               180        3600 male    2007
18 Adelie  Biscoe              35.9          19.2               189        3800 female  2007
19 Adelie  Biscoe              38.2          18.1               185        3950 male    2007
20 Adelie  Biscoe              38.8          17.2               180        3800 male    2007
21 Adelie  Biscoe              35.3          18.9               187        3800 female  2007
22 Adelie  Biscoe              40.6          18.6               183        3550 male    2007
23 Adelie  Biscoe              40.5          17.9               187        3200 female  2007
24 Adelie  Biscoe              37.9          18.6               172        3150 female  2007
25 Adelie  Biscoe              40.5          18.9               180        3950 male    2007
26 Adelie  Dream               39.5          16.7               178        3250 female  2007
27 Adelie  Dream               37.2          18.1               178        3900 male    2007
28 Adelie  Dream               39.5          17.8               188        3300 female  2007
29 Adelie  Dream               40.9          18.9               184        3900 male    2007
30 Adelie  Dream               36.4          17                 195        3325 female  2007
31 Adelie  Dream               39.2          21.1               196        4150 male    2007
32 Adelie  Dream               38.8          20                 190        3950 male    2007
33 Adelie  Dream               42.2          18.5               180        3550 female  2007
34 Adelie  Dream               37.6          19.3               181        3300 female  2007
35 Adelie  Dream               39.8          19.1               184        4650 male    2007
36 Adelie  Dream               36.5          18                 182        3150 female  2007
37 Adelie  Dream               40.8          18.4               195        3900 male    2007
38 Adelie  Dream               36            18.5               186        3100 female  2007
39 Adelie  Dream               44.1          19.7               196        4400 male    2007
40 Adelie  Dream               37            16.9               185        3000 female  2007
41 Adelie  Dream               39.6          18.8               190        4600 male    2007
42 Adelie  Dream               41.1          19                 182        3425 male    2007
43 Adelie  Dream               36            17.9               190        3450 female  2007
44 Adelie  Dream               42.3          21.2               191        4150 male    2007
45 Adelie  Biscoe              39.6          17.7               186        3500 female  2008
46 Adelie  Biscoe              40.1          18.9               188        4300 male    2008
47 Adelie  Biscoe              35            17.9               190        3450 female  2008
48 Adelie  Biscoe              42            19.5               200        4050 male    2008
49 Adelie  Biscoe              34.5          18.1               187        2900 female  2008
50 Adelie  Biscoe              41.4          18.6               191        3700 male    2008
51 Adelie  Biscoe              39            17.5               186        3550 female  2008
52 Adelie  Biscoe              40.6          18.8               193        3800 male    2008
53 Adelie  Biscoe              36.5          16.6               181        2850 female  2008
54 Adelie  Biscoe              37.6          19.1               194        3750 male    2008
55 Adelie  Biscoe              35.7          16.9               185        3150 female  2008
# ℹ 278 more rows
```

```
function(data,
                                     scales){
  data %&gt;%
    summarize(x = median(x),
              y = median(y))
}
&lt;environment: 0x7fc1f190f6d0&gt;
```
]

---
count: false
 

.panel1-compute_group_xy_medians-auto[

```r
compute_group_xy_medians &lt;- function(data,
                                     scales){
  data %&gt;%
    summarize(x = median(x),
              y = median(y))
}

penguins %&gt;%
# function requires dataframe
# with columns named x and y
* select(x = bill_depth_mm,
*        y = bill_length_mm)

compute_group_xy_medians
```
]
 
.panel2-compute_group_xy_medians-auto[

```
# A tibble: 333 × 2
       x     y
   &lt;dbl&gt; &lt;dbl&gt;
 1  18.7  39.1
 2  17.4  39.5
 3  18    40.3
 4  19.3  36.7
 5  20.6  39.3
 6  17.8  38.9
 7  19.6  39.2
 8  17.6  41.1
 9  21.2  38.6
10  21.1  34.6
11  17.8  36.6
12  19    38.7
13  20.7  42.5
14  18.4  34.4
15  21.5  46  
16  18.3  37.8
17  18.7  37.7
18  19.2  35.9
19  18.1  38.2
20  17.2  38.8
21  18.9  35.3
22  18.6  40.6
23  17.9  40.5
24  18.6  37.9
25  18.9  40.5
26  16.7  39.5
27  18.1  37.2
28  17.8  39.5
29  18.9  40.9
30  17    36.4
31  21.1  39.2
32  20    38.8
33  18.5  42.2
34  19.3  37.6
35  19.1  39.8
36  18    36.5
37  18.4  40.8
38  18.5  36  
39  19.7  44.1
40  16.9  37  
41  18.8  39.6
42  19    41.1
43  17.9  36  
44  21.2  42.3
45  17.7  39.6
46  18.9  40.1
47  17.9  35  
48  19.5  42  
49  18.1  34.5
50  18.6  41.4
51  17.5  39  
52  18.8  40.6
53  16.6  36.5
54  19.1  37.6
55  16.9  35.7
# ℹ 278 more rows
```

```
function(data,
                                     scales){
  data %&gt;%
    summarize(x = median(x),
              y = median(y))
}
&lt;environment: 0x7fc1f190f6d0&gt;
```
]

---
count: false
 

.panel1-compute_group_xy_medians-auto[

```r
compute_group_xy_medians &lt;- function(data,
                                     scales){
  data %&gt;%
    summarize(x = median(x),
              y = median(y))
}

penguins %&gt;%
# function requires dataframe
# with columns named x and y
  select(x = bill_depth_mm,
         y = bill_length_mm) %&gt;%
* compute_group_xy_medians()

compute_group_xy_medians
```
]
 
.panel2-compute_group_xy_medians-auto[

```
# A tibble: 1 × 2
      x     y
  &lt;dbl&gt; &lt;dbl&gt;
1  17.3  44.5
```

```
function(data,
                                     scales){
  data %&gt;%
    summarize(x = median(x),
              y = median(y))
}
&lt;environment: 0x7fc1f190f6d0&gt;
```
]

&lt;style&gt;
.panel1-compute_group_xy_medians-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-compute_group_xy_medians-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-compute_group_xy_medians-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;







---
class: inverse, middle, center

## Step 2: define ggproto

--

- what's the naming convention for the proto object?
- which aesthetics are required as inputs?
- where does the function from above go?

---


count: false
 

.panel1-StatXymedians-1[

```r
StatXymedians &lt;- ggplot2::ggproto(
  `_class` = "StatXymedians",  # declare new Stat
  `_inherit` = ggplot2::Stat,  # inherit behavior of generic stat
  required_aes = c("x", "y"),  # declare required variable mappings
  compute_group = compute_group_xy_medians  # pass computation definition for stat
  )
```
]
 
.panel2-StatXymedians-1[

]

&lt;style&gt;
.panel1-StatXymedians-1 {
  color: black;
  width: 81.6666666666667%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-StatXymedians-1 {
  color: black;
  width: 16.3333333333333%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-StatXymedians-1 {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;








---

Try using the stat in long-form, layer function. 

count: false
 

.panel1-layerStatXymedians-auto[

```r
*penguins
```
]
 
.panel2-layerStatXymedians-auto[

```
# A tibble: 333 × 8
   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex     year
   &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt; &lt;fct&gt;  &lt;int&gt;
 1 Adelie  Torgersen           39.1          18.7               181        3750 male    2007
 2 Adelie  Torgersen           39.5          17.4               186        3800 female  2007
 3 Adelie  Torgersen           40.3          18                 195        3250 female  2007
 4 Adelie  Torgersen           36.7          19.3               193        3450 female  2007
 5 Adelie  Torgersen           39.3          20.6               190        3650 male    2007
 6 Adelie  Torgersen           38.9          17.8               181        3625 female  2007
 7 Adelie  Torgersen           39.2          19.6               195        4675 male    2007
 8 Adelie  Torgersen           41.1          17.6               182        3200 female  2007
 9 Adelie  Torgersen           38.6          21.2               191        3800 male    2007
10 Adelie  Torgersen           34.6          21.1               198        4400 male    2007
11 Adelie  Torgersen           36.6          17.8               185        3700 female  2007
12 Adelie  Torgersen           38.7          19                 195        3450 female  2007
13 Adelie  Torgersen           42.5          20.7               197        4500 male    2007
14 Adelie  Torgersen           34.4          18.4               184        3325 female  2007
15 Adelie  Torgersen           46            21.5               194        4200 male    2007
16 Adelie  Biscoe              37.8          18.3               174        3400 female  2007
17 Adelie  Biscoe              37.7          18.7               180        3600 male    2007
18 Adelie  Biscoe              35.9          19.2               189        3800 female  2007
19 Adelie  Biscoe              38.2          18.1               185        3950 male    2007
20 Adelie  Biscoe              38.8          17.2               180        3800 male    2007
21 Adelie  Biscoe              35.3          18.9               187        3800 female  2007
22 Adelie  Biscoe              40.6          18.6               183        3550 male    2007
23 Adelie  Biscoe              40.5          17.9               187        3200 female  2007
24 Adelie  Biscoe              37.9          18.6               172        3150 female  2007
25 Adelie  Biscoe              40.5          18.9               180        3950 male    2007
26 Adelie  Dream               39.5          16.7               178        3250 female  2007
27 Adelie  Dream               37.2          18.1               178        3900 male    2007
28 Adelie  Dream               39.5          17.8               188        3300 female  2007
29 Adelie  Dream               40.9          18.9               184        3900 male    2007
30 Adelie  Dream               36.4          17                 195        3325 female  2007
31 Adelie  Dream               39.2          21.1               196        4150 male    2007
32 Adelie  Dream               38.8          20                 190        3950 male    2007
33 Adelie  Dream               42.2          18.5               180        3550 female  2007
34 Adelie  Dream               37.6          19.3               181        3300 female  2007
35 Adelie  Dream               39.8          19.1               184        4650 male    2007
36 Adelie  Dream               36.5          18                 182        3150 female  2007
37 Adelie  Dream               40.8          18.4               195        3900 male    2007
38 Adelie  Dream               36            18.5               186        3100 female  2007
39 Adelie  Dream               44.1          19.7               196        4400 male    2007
40 Adelie  Dream               37            16.9               185        3000 female  2007
41 Adelie  Dream               39.6          18.8               190        4600 male    2007
42 Adelie  Dream               41.1          19                 182        3425 male    2007
43 Adelie  Dream               36            17.9               190        3450 female  2007
44 Adelie  Dream               42.3          21.2               191        4150 male    2007
45 Adelie  Biscoe              39.6          17.7               186        3500 female  2008
46 Adelie  Biscoe              40.1          18.9               188        4300 male    2008
47 Adelie  Biscoe              35            17.9               190        3450 female  2008
48 Adelie  Biscoe              42            19.5               200        4050 male    2008
49 Adelie  Biscoe              34.5          18.1               187        2900 female  2008
50 Adelie  Biscoe              41.4          18.6               191        3700 male    2008
51 Adelie  Biscoe              39            17.5               186        3550 female  2008
52 Adelie  Biscoe              40.6          18.8               193        3800 male    2008
53 Adelie  Biscoe              36.5          16.6               181        2850 female  2008
54 Adelie  Biscoe              37.6          19.1               194        3750 male    2008
55 Adelie  Biscoe              35.7          16.9               185        3150 female  2008
# ℹ 278 more rows
```
]

---
count: false
 

.panel1-layerStatXymedians-auto[

```r
penguins %&gt;%
* ggplot()
```
]
 
.panel2-layerStatXymedians-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/layerStatXymedians_auto_02_output-1.png)&lt;!-- --&gt;
]

---
count: false
 

.panel1-layerStatXymedians-auto[

```r
penguins %&gt;%
  ggplot() +
* aes(x = bill_depth_mm)
```
]
 
.panel2-layerStatXymedians-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/layerStatXymedians_auto_03_output-1.png)&lt;!-- --&gt;
]

---
count: false
 

.panel1-layerStatXymedians-auto[

```r
penguins %&gt;%
  ggplot() +
  aes(x = bill_depth_mm) +
* aes(y = bill_length_mm)
```
]
 
.panel2-layerStatXymedians-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/layerStatXymedians_auto_04_output-1.png)&lt;!-- --&gt;
]

---
count: false
 

.panel1-layerStatXymedians-auto[

```r
penguins %&gt;%
  ggplot() +
  aes(x = bill_depth_mm) +
  aes(y = bill_length_mm) +
* geom_point()
```
]
 
.panel2-layerStatXymedians-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/layerStatXymedians_auto_05_output-1.png)&lt;!-- --&gt;
]

---
count: false
 

.panel1-layerStatXymedians-auto[

```r
penguins %&gt;%
  ggplot() +
  aes(x = bill_depth_mm) +
  aes(y = bill_length_mm) +
  geom_point() +
* layer(geom = GeomPoint, stat = StatXymedians,
*       position = "identity", params = list(size = 8))
```
]
 
.panel2-layerStatXymedians-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/layerStatXymedians_auto_06_output-1.png)&lt;!-- --&gt;
]

&lt;style&gt;
.panel1-layerStatXymedians-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-layerStatXymedians-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-layerStatXymedians-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;








---
class: inverse, middle, center

## Step 3: define user-facing geom_* function

For ease of use, we'll wrap the layer function into something that looks more familiar.  We also take care to manage arguments like mapping, data, position, na.rm, show.legend, inherit.aes, etc, so that your new, user-facing function will behaive similarly to other user-facing geom_*s.

- define the stat and geom for your layer

---


count: false
 

.panel1-geom_point_xy_medians-1[

```r
geom_point_xy_medians &lt;- function(
  mapping = NULL,  # global aesthetics will be used if NULL
  data = NULL,  # global data will be used if NULL
  position = "identity",
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE,
  ...  ){  # many other arguments can be used specific to  the Geom thats used in layer and to computation definition
ggplot2::layer(
    stat = StatXymedians,
    geom = ggplot2::GeomPoint,
    data = data,
    mapping = mapping,
    position = position,
    show.legend = show.legend,
    inherit.aes = inherit.aes,
    params = list(na.rm = na.rm, ...)
  )

}
```
]
 
.panel2-geom_point_xy_medians-1[

]

&lt;style&gt;
.panel1-geom_point_xy_medians-1 {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-geom_point_xy_medians-1 {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-geom_point_xy_medians-1 {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;






---
class: inverse, middle, center


## Step 4: Enjoy! Use your function


---


count: false
 

.panel1-enjoy_penguins-auto[

```r
*penguins

NA
```
]
 
.panel2-enjoy_penguins-auto[

```
# A tibble: 333 × 8
   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex     year
   &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt; &lt;fct&gt;  &lt;int&gt;
 1 Adelie  Torgersen           39.1          18.7               181        3750 male    2007
 2 Adelie  Torgersen           39.5          17.4               186        3800 female  2007
 3 Adelie  Torgersen           40.3          18                 195        3250 female  2007
 4 Adelie  Torgersen           36.7          19.3               193        3450 female  2007
 5 Adelie  Torgersen           39.3          20.6               190        3650 male    2007
 6 Adelie  Torgersen           38.9          17.8               181        3625 female  2007
 7 Adelie  Torgersen           39.2          19.6               195        4675 male    2007
 8 Adelie  Torgersen           41.1          17.6               182        3200 female  2007
 9 Adelie  Torgersen           38.6          21.2               191        3800 male    2007
10 Adelie  Torgersen           34.6          21.1               198        4400 male    2007
11 Adelie  Torgersen           36.6          17.8               185        3700 female  2007
12 Adelie  Torgersen           38.7          19                 195        3450 female  2007
13 Adelie  Torgersen           42.5          20.7               197        4500 male    2007
14 Adelie  Torgersen           34.4          18.4               184        3325 female  2007
15 Adelie  Torgersen           46            21.5               194        4200 male    2007
16 Adelie  Biscoe              37.8          18.3               174        3400 female  2007
17 Adelie  Biscoe              37.7          18.7               180        3600 male    2007
18 Adelie  Biscoe              35.9          19.2               189        3800 female  2007
19 Adelie  Biscoe              38.2          18.1               185        3950 male    2007
20 Adelie  Biscoe              38.8          17.2               180        3800 male    2007
21 Adelie  Biscoe              35.3          18.9               187        3800 female  2007
22 Adelie  Biscoe              40.6          18.6               183        3550 male    2007
23 Adelie  Biscoe              40.5          17.9               187        3200 female  2007
24 Adelie  Biscoe              37.9          18.6               172        3150 female  2007
25 Adelie  Biscoe              40.5          18.9               180        3950 male    2007
26 Adelie  Dream               39.5          16.7               178        3250 female  2007
27 Adelie  Dream               37.2          18.1               178        3900 male    2007
28 Adelie  Dream               39.5          17.8               188        3300 female  2007
29 Adelie  Dream               40.9          18.9               184        3900 male    2007
30 Adelie  Dream               36.4          17                 195        3325 female  2007
31 Adelie  Dream               39.2          21.1               196        4150 male    2007
32 Adelie  Dream               38.8          20                 190        3950 male    2007
33 Adelie  Dream               42.2          18.5               180        3550 female  2007
34 Adelie  Dream               37.6          19.3               181        3300 female  2007
35 Adelie  Dream               39.8          19.1               184        4650 male    2007
36 Adelie  Dream               36.5          18                 182        3150 female  2007
37 Adelie  Dream               40.8          18.4               195        3900 male    2007
38 Adelie  Dream               36            18.5               186        3100 female  2007
39 Adelie  Dream               44.1          19.7               196        4400 male    2007
40 Adelie  Dream               37            16.9               185        3000 female  2007
41 Adelie  Dream               39.6          18.8               190        4600 male    2007
42 Adelie  Dream               41.1          19                 182        3425 male    2007
43 Adelie  Dream               36            17.9               190        3450 female  2007
44 Adelie  Dream               42.3          21.2               191        4150 male    2007
45 Adelie  Biscoe              39.6          17.7               186        3500 female  2008
46 Adelie  Biscoe              40.1          18.9               188        4300 male    2008
47 Adelie  Biscoe              35            17.9               190        3450 female  2008
48 Adelie  Biscoe              42            19.5               200        4050 male    2008
49 Adelie  Biscoe              34.5          18.1               187        2900 female  2008
50 Adelie  Biscoe              41.4          18.6               191        3700 male    2008
51 Adelie  Biscoe              39            17.5               186        3550 female  2008
52 Adelie  Biscoe              40.6          18.8               193        3800 male    2008
53 Adelie  Biscoe              36.5          16.6               181        2850 female  2008
54 Adelie  Biscoe              37.6          19.1               194        3750 male    2008
55 Adelie  Biscoe              35.7          16.9               185        3150 female  2008
# ℹ 278 more rows
```

```
[1] NA
```
]

---
count: false
 

.panel1-enjoy_penguins-auto[

```r
penguins %&gt;%
* ggplot()

NA
```
]
 
.panel2-enjoy_penguins-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/enjoy_penguins_auto_02_output-1.png)&lt;!-- --&gt;

```
[1] NA
```
]

---
count: false
 

.panel1-enjoy_penguins-auto[

```r
penguins %&gt;%
  ggplot()+
* aes(x = bill_depth_mm,
*     y = bill_length_mm)

NA
```
]
 
.panel2-enjoy_penguins-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/enjoy_penguins_auto_03_output-1.png)&lt;!-- --&gt;

```
[1] NA
```
]

---
count: false
 

.panel1-enjoy_penguins-auto[

```r
penguins %&gt;%
  ggplot()+
  aes(x = bill_depth_mm,
      y = bill_length_mm) +
* geom_point()

NA
```
]
 
.panel2-enjoy_penguins-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/enjoy_penguins_auto_04_output-1.png)&lt;!-- --&gt;

```
[1] NA
```
]

---
count: false
 

.panel1-enjoy_penguins-auto[

```r
penguins %&gt;%
  ggplot()+
  aes(x = bill_depth_mm,
      y = bill_length_mm) +
  geom_point() +
* geom_point_xy_medians(color = "red")

NA
```
]
 
.panel2-enjoy_penguins-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/enjoy_penguins_auto_05_output-1.png)&lt;!-- --&gt;

```
[1] NA
```
]

&lt;style&gt;
.panel1-enjoy_penguins-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-enjoy_penguins-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-enjoy_penguins-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;






---
class: inverse, middle, center

### And check out conditionality!

---


count: false
 

.panel1-conditional_penguins-auto[

```r
*penguins

NA
```
]
 
.panel2-conditional_penguins-auto[

```
# A tibble: 333 × 8
   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex     year
   &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt; &lt;fct&gt;  &lt;int&gt;
 1 Adelie  Torgersen           39.1          18.7               181        3750 male    2007
 2 Adelie  Torgersen           39.5          17.4               186        3800 female  2007
 3 Adelie  Torgersen           40.3          18                 195        3250 female  2007
 4 Adelie  Torgersen           36.7          19.3               193        3450 female  2007
 5 Adelie  Torgersen           39.3          20.6               190        3650 male    2007
 6 Adelie  Torgersen           38.9          17.8               181        3625 female  2007
 7 Adelie  Torgersen           39.2          19.6               195        4675 male    2007
 8 Adelie  Torgersen           41.1          17.6               182        3200 female  2007
 9 Adelie  Torgersen           38.6          21.2               191        3800 male    2007
10 Adelie  Torgersen           34.6          21.1               198        4400 male    2007
11 Adelie  Torgersen           36.6          17.8               185        3700 female  2007
12 Adelie  Torgersen           38.7          19                 195        3450 female  2007
13 Adelie  Torgersen           42.5          20.7               197        4500 male    2007
14 Adelie  Torgersen           34.4          18.4               184        3325 female  2007
15 Adelie  Torgersen           46            21.5               194        4200 male    2007
16 Adelie  Biscoe              37.8          18.3               174        3400 female  2007
17 Adelie  Biscoe              37.7          18.7               180        3600 male    2007
18 Adelie  Biscoe              35.9          19.2               189        3800 female  2007
19 Adelie  Biscoe              38.2          18.1               185        3950 male    2007
20 Adelie  Biscoe              38.8          17.2               180        3800 male    2007
21 Adelie  Biscoe              35.3          18.9               187        3800 female  2007
22 Adelie  Biscoe              40.6          18.6               183        3550 male    2007
23 Adelie  Biscoe              40.5          17.9               187        3200 female  2007
24 Adelie  Biscoe              37.9          18.6               172        3150 female  2007
25 Adelie  Biscoe              40.5          18.9               180        3950 male    2007
26 Adelie  Dream               39.5          16.7               178        3250 female  2007
27 Adelie  Dream               37.2          18.1               178        3900 male    2007
28 Adelie  Dream               39.5          17.8               188        3300 female  2007
29 Adelie  Dream               40.9          18.9               184        3900 male    2007
30 Adelie  Dream               36.4          17                 195        3325 female  2007
31 Adelie  Dream               39.2          21.1               196        4150 male    2007
32 Adelie  Dream               38.8          20                 190        3950 male    2007
33 Adelie  Dream               42.2          18.5               180        3550 female  2007
34 Adelie  Dream               37.6          19.3               181        3300 female  2007
35 Adelie  Dream               39.8          19.1               184        4650 male    2007
36 Adelie  Dream               36.5          18                 182        3150 female  2007
37 Adelie  Dream               40.8          18.4               195        3900 male    2007
38 Adelie  Dream               36            18.5               186        3100 female  2007
39 Adelie  Dream               44.1          19.7               196        4400 male    2007
40 Adelie  Dream               37            16.9               185        3000 female  2007
41 Adelie  Dream               39.6          18.8               190        4600 male    2007
42 Adelie  Dream               41.1          19                 182        3425 male    2007
43 Adelie  Dream               36            17.9               190        3450 female  2007
44 Adelie  Dream               42.3          21.2               191        4150 male    2007
45 Adelie  Biscoe              39.6          17.7               186        3500 female  2008
46 Adelie  Biscoe              40.1          18.9               188        4300 male    2008
47 Adelie  Biscoe              35            17.9               190        3450 female  2008
48 Adelie  Biscoe              42            19.5               200        4050 male    2008
49 Adelie  Biscoe              34.5          18.1               187        2900 female  2008
50 Adelie  Biscoe              41.4          18.6               191        3700 male    2008
51 Adelie  Biscoe              39            17.5               186        3550 female  2008
52 Adelie  Biscoe              40.6          18.8               193        3800 male    2008
53 Adelie  Biscoe              36.5          16.6               181        2850 female  2008
54 Adelie  Biscoe              37.6          19.1               194        3750 male    2008
55 Adelie  Biscoe              35.7          16.9               185        3150 female  2008
# ℹ 278 more rows
```

```
[1] NA
```
]

---
count: false
 

.panel1-conditional_penguins-auto[

```r
penguins %&gt;%
* ggplot()

NA
```
]
 
.panel2-conditional_penguins-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/conditional_penguins_auto_02_output-1.png)&lt;!-- --&gt;

```
[1] NA
```
]

---
count: false
 

.panel1-conditional_penguins-auto[

```r
penguins %&gt;%
  ggplot() +
* aes(x = bill_depth_mm,
*     y = bill_length_mm,
*     color = species)

NA
```
]
 
.panel2-conditional_penguins-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/conditional_penguins_auto_03_output-1.png)&lt;!-- --&gt;

```
[1] NA
```
]

---
count: false
 

.panel1-conditional_penguins-auto[

```r
penguins %&gt;%
  ggplot() +
  aes(x = bill_depth_mm,
      y = bill_length_mm,
      color = species) +
* geom_point()

NA
```
]
 
.panel2-conditional_penguins-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/conditional_penguins_auto_04_output-1.png)&lt;!-- --&gt;

```
[1] NA
```
]

---
count: false
 

.panel1-conditional_penguins-auto[

```r
penguins %&gt;%
  ggplot() +
  aes(x = bill_depth_mm,
      y = bill_length_mm,
      color = species) +
  geom_point() +
* geom_point_xy_medians(size = 4)

NA
```
]
 
.panel2-conditional_penguins-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/conditional_penguins_auto_05_output-1.png)&lt;!-- --&gt;

```
[1] NA
```
]

&lt;style&gt;
.panel1-conditional_penguins-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-conditional_penguins-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-conditional_penguins-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;






---
class: inverse, middle, center
background-image: url(https://images.unsplash.com/photo-1628559225804-71f6e4643f44?ixlib=rb-1.2.1&amp;ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&amp;auto=format&amp;fit=crop&amp;w=837&amp;q=80)
background-size: cover



---
class: inverse, middle, center

## Now you ...

--

### Create the function `geom_point_xy_means()`

---
class: inverse, middle, center

# Recipe #2

--

## `geom_label_id()`


---
class: inverse, center, middle

## Step 0: use base ggplot2 to get the job done

---

count: false
 

.panel1-cars-auto[

```r
*cars
```
]
 
.panel2-cars-auto[

```
   speed dist
1      4    2
2      4   10
3      7    4
4      7   22
5      8   16
6      9   10
7     10   18
8     10   26
9     10   34
10    11   17
11    11   28
12    12   14
13    12   20
14    12   24
15    12   28
16    13   26
17    13   34
18    13   34
19    13   46
20    14   26
21    14   36
22    14   60
23    14   80
24    15   20
25    15   26
26    15   54
27    16   32
28    16   40
29    17   32
30    17   40
31    17   50
32    18   42
33    18   56
34    18   76
35    18   84
36    19   36
37    19   46
38    19   68
39    20   32
40    20   48
41    20   52
42    20   56
43    20   64
44    22   66
45    23   54
46    24   70
47    24   92
48    24   93
49    24  120
50    25   85
```
]

---
count: false
 

.panel1-cars-auto[

```r
cars %&gt;%
* mutate(id_number = 1:n())
```
]
 
.panel2-cars-auto[

```
   speed dist id_number
1      4    2         1
2      4   10         2
3      7    4         3
4      7   22         4
5      8   16         5
6      9   10         6
7     10   18         7
8     10   26         8
9     10   34         9
10    11   17        10
11    11   28        11
12    12   14        12
13    12   20        13
14    12   24        14
15    12   28        15
16    13   26        16
17    13   34        17
18    13   34        18
19    13   46        19
20    14   26        20
21    14   36        21
22    14   60        22
23    14   80        23
24    15   20        24
25    15   26        25
26    15   54        26
27    16   32        27
28    16   40        28
29    17   32        29
30    17   40        30
31    17   50        31
32    18   42        32
33    18   56        33
34    18   76        34
35    18   84        35
36    19   36        36
37    19   46        37
38    19   68        38
39    20   32        39
40    20   48        40
41    20   52        41
42    20   56        42
43    20   64        43
44    22   66        44
45    23   54        45
46    24   70        46
47    24   92        47
48    24   93        48
49    24  120        49
50    25   85        50
```
]

---
count: false
 

.panel1-cars-auto[

```r
cars %&gt;%
  mutate(id_number = 1:n()) %&gt;%
* ggplot()
```
]
 
.panel2-cars-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/cars_auto_03_output-1.png)&lt;!-- --&gt;
]

---
count: false
 

.panel1-cars-auto[

```r
cars %&gt;%
  mutate(id_number = 1:n()) %&gt;%
  ggplot() +
* aes(x = speed, y = dist)
```
]
 
.panel2-cars-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/cars_auto_04_output-1.png)&lt;!-- --&gt;
]

---
count: false
 

.panel1-cars-auto[

```r
cars %&gt;%
  mutate(id_number = 1:n()) %&gt;%
  ggplot() +
  aes(x = speed, y = dist) +
* geom_point()
```
]
 
.panel2-cars-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/cars_auto_05_output-1.png)&lt;!-- --&gt;
]

---
count: false
 

.panel1-cars-auto[

```r
cars %&gt;%
  mutate(id_number = 1:n()) %&gt;%
  ggplot() +
  aes(x = speed, y = dist) +
  geom_point() +
* geom_label(aes(label = id_number),
*            hjust = 1.2)
```
]
 
.panel2-cars-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/cars_auto_06_output-1.png)&lt;!-- --&gt;
]

&lt;style&gt;
.panel1-cars-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-cars-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-cars-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;






---
class: inverse, middle, center

## Step 1: computation



---


count: false
 

.panel1-compute_group_row_number-auto[

```r
# you won't use the scales argument, but ggplot will later
*compute_group_row_number &lt;- function(data,
*                                    scales){

* data %&gt;%
# add an additional column called label
# the geom we inherit from requires the label aesthetic
*   mutate(label = 1:n())

*} 

NA
```
]
 
.panel2-compute_group_row_number-auto[

```
[1] NA
```
]

---
count: false
 

.panel1-compute_group_row_number-auto[

```r
# you won't use the scales argument, but ggplot will later
compute_group_row_number &lt;- function(data,
                                     scales){

  data %&gt;%
# add an additional column called label
# the geom we inherit from requires the label aesthetic
    mutate(label = 1:n())

}

# step 1b test the computation function
*cars

NA
```
]
 
.panel2-compute_group_row_number-auto[

```
   speed dist
1      4    2
2      4   10
3      7    4
4      7   22
5      8   16
6      9   10
7     10   18
8     10   26
9     10   34
10    11   17
11    11   28
12    12   14
13    12   20
14    12   24
15    12   28
16    13   26
17    13   34
18    13   34
19    13   46
20    14   26
21    14   36
22    14   60
23    14   80
24    15   20
25    15   26
26    15   54
27    16   32
28    16   40
29    17   32
30    17   40
31    17   50
32    18   42
33    18   56
34    18   76
35    18   84
36    19   36
37    19   46
38    19   68
39    20   32
40    20   48
41    20   52
42    20   56
43    20   64
44    22   66
45    23   54
46    24   70
47    24   92
48    24   93
49    24  120
50    25   85
```

```
[1] NA
```
]

---
count: false
 

.panel1-compute_group_row_number-auto[

```r
# you won't use the scales argument, but ggplot will later
compute_group_row_number &lt;- function(data,
                                     scales){

  data %&gt;%
# add an additional column called label
# the geom we inherit from requires the label aesthetic
    mutate(label = 1:n())

}

# step 1b test the computation function
cars %&gt;%
# input must have required aesthetic inputs as columns
* select(x = speed,
*        y = dist)

NA
```
]
 
.panel2-compute_group_row_number-auto[

```
    x   y
1   4   2
2   4  10
3   7   4
4   7  22
5   8  16
6   9  10
7  10  18
8  10  26
9  10  34
10 11  17
11 11  28
12 12  14
13 12  20
14 12  24
15 12  28
16 13  26
17 13  34
18 13  34
19 13  46
20 14  26
21 14  36
22 14  60
23 14  80
24 15  20
25 15  26
26 15  54
27 16  32
28 16  40
29 17  32
30 17  40
31 17  50
32 18  42
33 18  56
34 18  76
35 18  84
36 19  36
37 19  46
38 19  68
39 20  32
40 20  48
41 20  52
42 20  56
43 20  64
44 22  66
45 23  54
46 24  70
47 24  92
48 24  93
49 24 120
50 25  85
```

```
[1] NA
```
]

---
count: false
 

.panel1-compute_group_row_number-auto[

```r
# you won't use the scales argument, but ggplot will later
compute_group_row_number &lt;- function(data,
                                     scales){

  data %&gt;%
# add an additional column called label
# the geom we inherit from requires the label aesthetic
    mutate(label = 1:n())

}

# step 1b test the computation function
cars %&gt;%
# input must have required aesthetic inputs as columns
  select(x = speed,
         y = dist) %&gt;%
* compute_group_row_number()

NA
```
]
 
.panel2-compute_group_row_number-auto[

```
    x   y label
1   4   2     1
2   4  10     2
3   7   4     3
4   7  22     4
5   8  16     5
6   9  10     6
7  10  18     7
8  10  26     8
9  10  34     9
10 11  17    10
11 11  28    11
12 12  14    12
13 12  20    13
14 12  24    14
15 12  28    15
16 13  26    16
17 13  34    17
18 13  34    18
19 13  46    19
20 14  26    20
21 14  36    21
22 14  60    22
23 14  80    23
24 15  20    24
25 15  26    25
26 15  54    26
27 16  32    27
28 16  40    28
29 17  32    29
30 17  40    30
31 17  50    31
32 18  42    32
33 18  56    33
34 18  76    34
35 18  84    35
36 19  36    36
37 19  46    37
38 19  68    38
39 20  32    39
40 20  48    40
41 20  52    41
42 20  56    42
43 20  64    43
44 22  66    44
45 23  54    45
46 24  70    46
47 24  92    47
48 24  93    48
49 24 120    49
50 25  85    50
```

```
[1] NA
```
]

&lt;style&gt;
.panel1-compute_group_row_number-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-compute_group_row_number-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-compute_group_row_number-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;






---
class: inverse, middle, center

## Step 2: define ggproto


---


count: false
 

.panel1-StatRownumber-1[

```r
StatRownumber &lt;- ggplot2::ggproto(
  `_class` = "StatRownumber",
  `_inherit` = ggplot2::Stat,
  required_aes = c("x", "y"),
  compute_group = compute_group_row_number
  )
```
]
 
.panel2-StatRownumber-1[

]

&lt;style&gt;
.panel1-StatRownumber-1 {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-StatRownumber-1 {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-StatRownumber-1 {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;






---
class: inverse, middle, center

## Step 2.b: test




```r
cars %&gt;% 
  mutate(id_number = 1:n()) %&gt;% 
  ggplot() + 
  aes(x = speed, y = dist) + 
  geom_point() + 
  layer(geom = GeomText,
        stat = StatRownumber,
        position = "identity")
```

![](easy_geom_recipes_flipbook_2024_files/figure-html/unnamed-chunk-3-1.png)&lt;!-- --&gt;


---
class: inverse, middle, center

## Step 3: define user-facing geom_* function

---


count: false
 

.panel1-geom_label_row_number-1[

```r
geom_label_row_number &lt;- function(
  mapping = NULL,
  data = NULL,
  position = "identity",
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE, ...) {

  ggplot2::layer(
    stat = StatRownumber,  # proto object from Step 2
    geom = ggplot2::GeomLabel,  # inherit other behavior
    data = data,
    mapping = mapping,
    position = position,
    show.legend = show.legend,
    inherit.aes = inherit.aes,
    params = list(na.rm = na.rm, ...)

  )
}
```
]
 
.panel2-geom_label_row_number-1[

]

&lt;style&gt;
.panel1-geom_label_row_number-1 {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-geom_label_row_number-1 {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-geom_label_row_number-1 {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;







---
class: inverse, middle, center


## Step 4: Enjoy! Use your function


---


count: false
 

.panel1-enjoy_again-auto[

```r
*cars

NA
```
]
 
.panel2-enjoy_again-auto[

```
   speed dist
1      4    2
2      4   10
3      7    4
4      7   22
5      8   16
6      9   10
7     10   18
8     10   26
9     10   34
10    11   17
11    11   28
12    12   14
13    12   20
14    12   24
15    12   28
16    13   26
17    13   34
18    13   34
19    13   46
20    14   26
21    14   36
22    14   60
23    14   80
24    15   20
25    15   26
26    15   54
27    16   32
28    16   40
29    17   32
30    17   40
31    17   50
32    18   42
33    18   56
34    18   76
35    18   84
36    19   36
37    19   46
38    19   68
39    20   32
40    20   48
41    20   52
42    20   56
43    20   64
44    22   66
45    23   54
46    24   70
47    24   92
48    24   93
49    24  120
50    25   85
```

```
[1] NA
```
]

---
count: false
 

.panel1-enjoy_again-auto[

```r
cars %&gt;%
* ggplot()

NA
```
]
 
.panel2-enjoy_again-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/enjoy_again_auto_02_output-1.png)&lt;!-- --&gt;

```
[1] NA
```
]

---
count: false
 

.panel1-enjoy_again-auto[

```r
cars %&gt;%
  ggplot() +
* aes(x = speed, y = dist)

NA
```
]
 
.panel2-enjoy_again-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/enjoy_again_auto_03_output-1.png)&lt;!-- --&gt;

```
[1] NA
```
]

---
count: false
 

.panel1-enjoy_again-auto[

```r
cars %&gt;%
  ggplot() +
  aes(x = speed, y = dist) +
* geom_point()

NA
```
]
 
.panel2-enjoy_again-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/enjoy_again_auto_04_output-1.png)&lt;!-- --&gt;

```
[1] NA
```
]

---
count: false
 

.panel1-enjoy_again-auto[

```r
cars %&gt;%
  ggplot() +
  aes(x = speed, y = dist) +
  geom_point() +
* geom_label_row_number(hjust = 1.2)  # function in action

NA
```
]
 
.panel2-enjoy_again-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/enjoy_again_auto_05_output-1.png)&lt;!-- --&gt;

```
[1] NA
```
]

&lt;style&gt;
.panel1-enjoy_again-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-enjoy_again-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-enjoy_again-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;






---
class: inverse, middle, center

### And check out conditionality!

---


count: false
 

.panel1-conditional_compute-auto[

```r
*last_plot()

NA
```
]
 
.panel2-conditional_compute-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/conditional_compute_auto_01_output-1.png)&lt;!-- --&gt;

```
[1] NA
```
]

---
count: false
 

.panel1-conditional_compute-auto[

```r
last_plot() +
* aes(color = dist &gt; 60)

NA
```
]
 
.panel2-conditional_compute-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/conditional_compute_auto_02_output-1.png)&lt;!-- --&gt;

```
[1] NA
```
]

&lt;style&gt;
.panel1-conditional_compute-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-conditional_compute-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-conditional_compute-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;







---
class: inverse, middle, center
background-image: url(https://images.unsplash.com/photo-1530751127259-074b0cdc0469?ixlib=rb-1.2.1&amp;ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&amp;auto=format&amp;fit=crop&amp;w=1413&amp;q=80)
background-size: cover

---
class: inverse, middle, center

## Now you...

--

### Create the function `geom_text_coordinates()`.  

--

- geom should label point with its coordinates '(x, y)'
- geom should have behavior of geom_text (not geom_label)


Hint: `paste0("(", 1, ", ",3., ")")`



---
class: inverse, middle, center

# Recipe #3:  

--


## `geom_point_lm_fitted()`

---

## Step 0: use base ggplot2 to get the job done

---


count: false
 

.panel1-fitted_1-auto[

```r
*model &lt;- lm(formula =
*             bill_length_mm ~ bill_depth_mm,
*           data = penguins)
```
]
 
.panel2-fitted_1-auto[

]

---
count: false
 

.panel1-fitted_1-auto[

```r
model &lt;- lm(formula =
              bill_length_mm ~ bill_depth_mm,
            data = penguins)

*penguins_w_fitted &lt;- penguins
```
]
 
.panel2-fitted_1-auto[

]

---
count: false
 

.panel1-fitted_1-auto[

```r
model &lt;- lm(formula =
              bill_length_mm ~ bill_depth_mm,
            data = penguins)

penguins_w_fitted &lt;- penguins %&gt;%
* mutate(fitted = model$fitted.values)
```
]
 
.panel2-fitted_1-auto[

]

---
count: false
 

.panel1-fitted_1-auto[

```r
model &lt;- lm(formula =
              bill_length_mm ~ bill_depth_mm,
            data = penguins)

penguins_w_fitted &lt;- penguins %&gt;%
  mutate(fitted = model$fitted.values)


*penguins
```
]
 
.panel2-fitted_1-auto[

```
# A tibble: 333 × 8
   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex     year
   &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt; &lt;fct&gt;  &lt;int&gt;
 1 Adelie  Torgersen           39.1          18.7               181        3750 male    2007
 2 Adelie  Torgersen           39.5          17.4               186        3800 female  2007
 3 Adelie  Torgersen           40.3          18                 195        3250 female  2007
 4 Adelie  Torgersen           36.7          19.3               193        3450 female  2007
 5 Adelie  Torgersen           39.3          20.6               190        3650 male    2007
 6 Adelie  Torgersen           38.9          17.8               181        3625 female  2007
 7 Adelie  Torgersen           39.2          19.6               195        4675 male    2007
 8 Adelie  Torgersen           41.1          17.6               182        3200 female  2007
 9 Adelie  Torgersen           38.6          21.2               191        3800 male    2007
10 Adelie  Torgersen           34.6          21.1               198        4400 male    2007
11 Adelie  Torgersen           36.6          17.8               185        3700 female  2007
12 Adelie  Torgersen           38.7          19                 195        3450 female  2007
13 Adelie  Torgersen           42.5          20.7               197        4500 male    2007
14 Adelie  Torgersen           34.4          18.4               184        3325 female  2007
15 Adelie  Torgersen           46            21.5               194        4200 male    2007
16 Adelie  Biscoe              37.8          18.3               174        3400 female  2007
17 Adelie  Biscoe              37.7          18.7               180        3600 male    2007
18 Adelie  Biscoe              35.9          19.2               189        3800 female  2007
19 Adelie  Biscoe              38.2          18.1               185        3950 male    2007
20 Adelie  Biscoe              38.8          17.2               180        3800 male    2007
21 Adelie  Biscoe              35.3          18.9               187        3800 female  2007
22 Adelie  Biscoe              40.6          18.6               183        3550 male    2007
23 Adelie  Biscoe              40.5          17.9               187        3200 female  2007
24 Adelie  Biscoe              37.9          18.6               172        3150 female  2007
25 Adelie  Biscoe              40.5          18.9               180        3950 male    2007
26 Adelie  Dream               39.5          16.7               178        3250 female  2007
27 Adelie  Dream               37.2          18.1               178        3900 male    2007
28 Adelie  Dream               39.5          17.8               188        3300 female  2007
29 Adelie  Dream               40.9          18.9               184        3900 male    2007
30 Adelie  Dream               36.4          17                 195        3325 female  2007
31 Adelie  Dream               39.2          21.1               196        4150 male    2007
32 Adelie  Dream               38.8          20                 190        3950 male    2007
33 Adelie  Dream               42.2          18.5               180        3550 female  2007
34 Adelie  Dream               37.6          19.3               181        3300 female  2007
35 Adelie  Dream               39.8          19.1               184        4650 male    2007
36 Adelie  Dream               36.5          18                 182        3150 female  2007
37 Adelie  Dream               40.8          18.4               195        3900 male    2007
38 Adelie  Dream               36            18.5               186        3100 female  2007
39 Adelie  Dream               44.1          19.7               196        4400 male    2007
40 Adelie  Dream               37            16.9               185        3000 female  2007
41 Adelie  Dream               39.6          18.8               190        4600 male    2007
42 Adelie  Dream               41.1          19                 182        3425 male    2007
43 Adelie  Dream               36            17.9               190        3450 female  2007
44 Adelie  Dream               42.3          21.2               191        4150 male    2007
45 Adelie  Biscoe              39.6          17.7               186        3500 female  2008
46 Adelie  Biscoe              40.1          18.9               188        4300 male    2008
47 Adelie  Biscoe              35            17.9               190        3450 female  2008
48 Adelie  Biscoe              42            19.5               200        4050 male    2008
49 Adelie  Biscoe              34.5          18.1               187        2900 female  2008
50 Adelie  Biscoe              41.4          18.6               191        3700 male    2008
51 Adelie  Biscoe              39            17.5               186        3550 female  2008
52 Adelie  Biscoe              40.6          18.8               193        3800 male    2008
53 Adelie  Biscoe              36.5          16.6               181        2850 female  2008
54 Adelie  Biscoe              37.6          19.1               194        3750 male    2008
55 Adelie  Biscoe              35.7          16.9               185        3150 female  2008
# ℹ 278 more rows
```
]

---
count: false
 

.panel1-fitted_1-auto[

```r
model &lt;- lm(formula =
              bill_length_mm ~ bill_depth_mm,
            data = penguins)

penguins_w_fitted &lt;- penguins %&gt;%
  mutate(fitted = model$fitted.values)


penguins %&gt;%
* ggplot()
```
]
 
.panel2-fitted_1-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/fitted_1_auto_05_output-1.png)&lt;!-- --&gt;
]

---
count: false
 

.panel1-fitted_1-auto[

```r
model &lt;- lm(formula =
              bill_length_mm ~ bill_depth_mm,
            data = penguins)

penguins_w_fitted &lt;- penguins %&gt;%
  mutate(fitted = model$fitted.values)


penguins %&gt;%
  ggplot() +
* aes(x = bill_depth_mm, y = bill_length_mm)
```
]
 
.panel2-fitted_1-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/fitted_1_auto_06_output-1.png)&lt;!-- --&gt;
]

---
count: false
 

.panel1-fitted_1-auto[

```r
model &lt;- lm(formula =
              bill_length_mm ~ bill_depth_mm,
            data = penguins)

penguins_w_fitted &lt;- penguins %&gt;%
  mutate(fitted = model$fitted.values)


penguins %&gt;%
  ggplot() +
  aes(x = bill_depth_mm, y = bill_length_mm) +
* geom_point()
```
]
 
.panel2-fitted_1-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/fitted_1_auto_07_output-1.png)&lt;!-- --&gt;
]

---
count: false
 

.panel1-fitted_1-auto[

```r
model &lt;- lm(formula =
              bill_length_mm ~ bill_depth_mm,
            data = penguins)

penguins_w_fitted &lt;- penguins %&gt;%
  mutate(fitted = model$fitted.values)


penguins %&gt;%
  ggplot() +
  aes(x = bill_depth_mm, y = bill_length_mm) +
  geom_point() +
* geom_smooth(method = "lm", se = F)
```
]
 
.panel2-fitted_1-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/fitted_1_auto_08_output-1.png)&lt;!-- --&gt;
]

---
count: false
 

.panel1-fitted_1-auto[

```r
model &lt;- lm(formula =
              bill_length_mm ~ bill_depth_mm,
            data = penguins)

penguins_w_fitted &lt;- penguins %&gt;%
  mutate(fitted = model$fitted.values)


penguins %&gt;%
  ggplot() +
  aes(x = bill_depth_mm, y = bill_length_mm) +
  geom_point() +
  geom_smooth(method = "lm", se = F) +
* geom_point(data = penguins_w_fitted,
*            aes(y = fitted),
*            color = "blue")
```
]
 
.panel2-fitted_1-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/fitted_1_auto_09_output-1.png)&lt;!-- --&gt;
]

&lt;style&gt;
.panel1-fitted_1-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-fitted_1-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-fitted_1-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;






---
class: inverse, middle, center

## Step 1: computation

---


count: false
 

.panel1-fitted_2-auto[

```r
*compute_group_lm_fitted &lt;- function(data,
*                                  scales){
* model&lt;-lm(formula= y ~ x, data = data)
* data %&gt;%
*   mutate(y=model$fitted.values)
*} 
```
]
 
.panel2-fitted_2-auto[

]

---
count: false
 

.panel1-fitted_2-auto[

```r
compute_group_lm_fitted &lt;- function(data,
                                   scales){
  model&lt;-lm(formula= y ~ x, data = data)
  data %&gt;%
    mutate(y=model$fitted.values)
}

# test out the function
*penguins
```
]
 
.panel2-fitted_2-auto[

```
# A tibble: 333 × 8
   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex     year
   &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt; &lt;fct&gt;  &lt;int&gt;
 1 Adelie  Torgersen           39.1          18.7               181        3750 male    2007
 2 Adelie  Torgersen           39.5          17.4               186        3800 female  2007
 3 Adelie  Torgersen           40.3          18                 195        3250 female  2007
 4 Adelie  Torgersen           36.7          19.3               193        3450 female  2007
 5 Adelie  Torgersen           39.3          20.6               190        3650 male    2007
 6 Adelie  Torgersen           38.9          17.8               181        3625 female  2007
 7 Adelie  Torgersen           39.2          19.6               195        4675 male    2007
 8 Adelie  Torgersen           41.1          17.6               182        3200 female  2007
 9 Adelie  Torgersen           38.6          21.2               191        3800 male    2007
10 Adelie  Torgersen           34.6          21.1               198        4400 male    2007
11 Adelie  Torgersen           36.6          17.8               185        3700 female  2007
12 Adelie  Torgersen           38.7          19                 195        3450 female  2007
13 Adelie  Torgersen           42.5          20.7               197        4500 male    2007
14 Adelie  Torgersen           34.4          18.4               184        3325 female  2007
15 Adelie  Torgersen           46            21.5               194        4200 male    2007
16 Adelie  Biscoe              37.8          18.3               174        3400 female  2007
17 Adelie  Biscoe              37.7          18.7               180        3600 male    2007
18 Adelie  Biscoe              35.9          19.2               189        3800 female  2007
19 Adelie  Biscoe              38.2          18.1               185        3950 male    2007
20 Adelie  Biscoe              38.8          17.2               180        3800 male    2007
21 Adelie  Biscoe              35.3          18.9               187        3800 female  2007
22 Adelie  Biscoe              40.6          18.6               183        3550 male    2007
23 Adelie  Biscoe              40.5          17.9               187        3200 female  2007
24 Adelie  Biscoe              37.9          18.6               172        3150 female  2007
25 Adelie  Biscoe              40.5          18.9               180        3950 male    2007
26 Adelie  Dream               39.5          16.7               178        3250 female  2007
27 Adelie  Dream               37.2          18.1               178        3900 male    2007
28 Adelie  Dream               39.5          17.8               188        3300 female  2007
29 Adelie  Dream               40.9          18.9               184        3900 male    2007
30 Adelie  Dream               36.4          17                 195        3325 female  2007
31 Adelie  Dream               39.2          21.1               196        4150 male    2007
32 Adelie  Dream               38.8          20                 190        3950 male    2007
33 Adelie  Dream               42.2          18.5               180        3550 female  2007
34 Adelie  Dream               37.6          19.3               181        3300 female  2007
35 Adelie  Dream               39.8          19.1               184        4650 male    2007
36 Adelie  Dream               36.5          18                 182        3150 female  2007
37 Adelie  Dream               40.8          18.4               195        3900 male    2007
38 Adelie  Dream               36            18.5               186        3100 female  2007
39 Adelie  Dream               44.1          19.7               196        4400 male    2007
40 Adelie  Dream               37            16.9               185        3000 female  2007
41 Adelie  Dream               39.6          18.8               190        4600 male    2007
42 Adelie  Dream               41.1          19                 182        3425 male    2007
43 Adelie  Dream               36            17.9               190        3450 female  2007
44 Adelie  Dream               42.3          21.2               191        4150 male    2007
45 Adelie  Biscoe              39.6          17.7               186        3500 female  2008
46 Adelie  Biscoe              40.1          18.9               188        4300 male    2008
47 Adelie  Biscoe              35            17.9               190        3450 female  2008
48 Adelie  Biscoe              42            19.5               200        4050 male    2008
49 Adelie  Biscoe              34.5          18.1               187        2900 female  2008
50 Adelie  Biscoe              41.4          18.6               191        3700 male    2008
51 Adelie  Biscoe              39            17.5               186        3550 female  2008
52 Adelie  Biscoe              40.6          18.8               193        3800 male    2008
53 Adelie  Biscoe              36.5          16.6               181        2850 female  2008
54 Adelie  Biscoe              37.6          19.1               194        3750 male    2008
55 Adelie  Biscoe              35.7          16.9               185        3150 female  2008
# ℹ 278 more rows
```
]

---
count: false
 

.panel1-fitted_2-auto[

```r
compute_group_lm_fitted &lt;- function(data,
                                   scales){
  model&lt;-lm(formula= y ~ x, data = data)
  data %&gt;%
    mutate(y=model$fitted.values)
}

# test out the function
penguins %&gt;%
# select to explicitly state the x and y inputs
* select(x = bill_depth_mm,
*        y = bill_length_mm)
```
]
 
.panel2-fitted_2-auto[

```
# A tibble: 333 × 2
       x     y
   &lt;dbl&gt; &lt;dbl&gt;
 1  18.7  39.1
 2  17.4  39.5
 3  18    40.3
 4  19.3  36.7
 5  20.6  39.3
 6  17.8  38.9
 7  19.6  39.2
 8  17.6  41.1
 9  21.2  38.6
10  21.1  34.6
11  17.8  36.6
12  19    38.7
13  20.7  42.5
14  18.4  34.4
15  21.5  46  
16  18.3  37.8
17  18.7  37.7
18  19.2  35.9
19  18.1  38.2
20  17.2  38.8
21  18.9  35.3
22  18.6  40.6
23  17.9  40.5
24  18.6  37.9
25  18.9  40.5
26  16.7  39.5
27  18.1  37.2
28  17.8  39.5
29  18.9  40.9
30  17    36.4
31  21.1  39.2
32  20    38.8
33  18.5  42.2
34  19.3  37.6
35  19.1  39.8
36  18    36.5
37  18.4  40.8
38  18.5  36  
39  19.7  44.1
40  16.9  37  
41  18.8  39.6
42  19    41.1
43  17.9  36  
44  21.2  42.3
45  17.7  39.6
46  18.9  40.1
47  17.9  35  
48  19.5  42  
49  18.1  34.5
50  18.6  41.4
51  17.5  39  
52  18.8  40.6
53  16.6  36.5
54  19.1  37.6
55  16.9  35.7
# ℹ 278 more rows
```
]

---
count: false
 

.panel1-fitted_2-auto[

```r
compute_group_lm_fitted &lt;- function(data,
                                   scales){
  model&lt;-lm(formula= y ~ x, data = data)
  data %&gt;%
    mutate(y=model$fitted.values)
}

# test out the function
penguins %&gt;%
# select to explicitly state the x and y inputs
  select(x = bill_depth_mm,
         y = bill_length_mm) %&gt;%
* compute_group_lm_fitted()
```
]
 
.panel2-fitted_2-auto[

```
# A tibble: 333 × 2
       x     y
   &lt;dbl&gt; &lt;dbl&gt;
 1  18.7  43.0
 2  17.4  43.8
 3  18    43.5
 4  19.3  42.6
 5  20.6  41.8
 6  17.8  43.6
 7  19.6  42.4
 8  17.6  43.7
 9  21.2  41.4
10  21.1  41.5
11  17.8  43.6
12  19    42.8
13  20.7  41.7
14  18.4  43.2
15  21.5  41.2
16  18.3  43.3
17  18.7  43.0
18  19.2  42.7
19  18.1  43.4
20  17.2  44.0
21  18.9  42.9
22  18.6  43.1
23  17.9  43.5
24  18.6  43.1
25  18.9  42.9
26  16.7  44.3
27  18.1  43.4
28  17.8  43.6
29  18.9  42.9
30  17    44.1
31  21.1  41.5
32  20    42.2
33  18.5  43.1
34  19.3  42.6
35  19.1  42.8
36  18    43.5
37  18.4  43.2
38  18.5  43.1
39  19.7  42.4
40  16.9  44.2
41  18.8  43.0
42  19    42.8
43  17.9  43.5
44  21.2  41.4
45  17.7  43.7
46  18.9  42.9
47  17.9  43.5
48  19.5  42.5
49  18.1  43.4
50  18.6  43.1
51  17.5  43.8
52  18.8  43.0
53  16.6  44.4
54  19.1  42.8
55  16.9  44.2
# ℹ 278 more rows
```
]

&lt;style&gt;
.panel1-fitted_2-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-fitted_2-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-fitted_2-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;







## Step 2: define ggproto

---


count: false
 

.panel1-fitted_3-1[

```r
StatLmFitted &lt;- ggplot2::ggproto(
  `_class` = "StatLmFitted",
  `_inherit` = ggplot2::Stat,
  required_aes = c("x", "y"),
  compute_group = compute_group_lm_fitted
  )
```
]
 
.panel2-fitted_3-1[

]

&lt;style&gt;
.panel1-fitted_3-1 {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-fitted_3-1 {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-fitted_3-1 {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;







## Step 3: define geom_* function


---


count: false
 

.panel1-fitted_4-1[

```r
geom_point_lm_fitted &lt;- function(
  mapping = NULL, data = NULL,
  position = "identity",
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE, ...) {

  ggplot2::layer(
    stat = StatLmFitted,  # proto object from step 2
    geom = ggplot2::GeomPoint,  # inherit other behavior
    data = data,
    mapping = mapping,
    position = position,
    show.legend = show.legend,
    inherit.aes = inherit.aes,
    params = list(na.rm = na.rm, ...)
  )

}
```
]
 
.panel2-fitted_4-1[

]

&lt;style&gt;
.panel1-fitted_4-1 {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-fitted_4-1 {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-fitted_4-1 {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;






---
class: inverse, middle, center


## Step 4: Enjoy! Use your function



---


count: false
 

.panel1-fitted_5-auto[

```r
*penguins

NA
```
]
 
.panel2-fitted_5-auto[

```
# A tibble: 333 × 8
   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex     year
   &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt; &lt;fct&gt;  &lt;int&gt;
 1 Adelie  Torgersen           39.1          18.7               181        3750 male    2007
 2 Adelie  Torgersen           39.5          17.4               186        3800 female  2007
 3 Adelie  Torgersen           40.3          18                 195        3250 female  2007
 4 Adelie  Torgersen           36.7          19.3               193        3450 female  2007
 5 Adelie  Torgersen           39.3          20.6               190        3650 male    2007
 6 Adelie  Torgersen           38.9          17.8               181        3625 female  2007
 7 Adelie  Torgersen           39.2          19.6               195        4675 male    2007
 8 Adelie  Torgersen           41.1          17.6               182        3200 female  2007
 9 Adelie  Torgersen           38.6          21.2               191        3800 male    2007
10 Adelie  Torgersen           34.6          21.1               198        4400 male    2007
11 Adelie  Torgersen           36.6          17.8               185        3700 female  2007
12 Adelie  Torgersen           38.7          19                 195        3450 female  2007
13 Adelie  Torgersen           42.5          20.7               197        4500 male    2007
14 Adelie  Torgersen           34.4          18.4               184        3325 female  2007
15 Adelie  Torgersen           46            21.5               194        4200 male    2007
16 Adelie  Biscoe              37.8          18.3               174        3400 female  2007
17 Adelie  Biscoe              37.7          18.7               180        3600 male    2007
18 Adelie  Biscoe              35.9          19.2               189        3800 female  2007
19 Adelie  Biscoe              38.2          18.1               185        3950 male    2007
20 Adelie  Biscoe              38.8          17.2               180        3800 male    2007
21 Adelie  Biscoe              35.3          18.9               187        3800 female  2007
22 Adelie  Biscoe              40.6          18.6               183        3550 male    2007
23 Adelie  Biscoe              40.5          17.9               187        3200 female  2007
24 Adelie  Biscoe              37.9          18.6               172        3150 female  2007
25 Adelie  Biscoe              40.5          18.9               180        3950 male    2007
26 Adelie  Dream               39.5          16.7               178        3250 female  2007
27 Adelie  Dream               37.2          18.1               178        3900 male    2007
28 Adelie  Dream               39.5          17.8               188        3300 female  2007
29 Adelie  Dream               40.9          18.9               184        3900 male    2007
30 Adelie  Dream               36.4          17                 195        3325 female  2007
31 Adelie  Dream               39.2          21.1               196        4150 male    2007
32 Adelie  Dream               38.8          20                 190        3950 male    2007
33 Adelie  Dream               42.2          18.5               180        3550 female  2007
34 Adelie  Dream               37.6          19.3               181        3300 female  2007
35 Adelie  Dream               39.8          19.1               184        4650 male    2007
36 Adelie  Dream               36.5          18                 182        3150 female  2007
37 Adelie  Dream               40.8          18.4               195        3900 male    2007
38 Adelie  Dream               36            18.5               186        3100 female  2007
39 Adelie  Dream               44.1          19.7               196        4400 male    2007
40 Adelie  Dream               37            16.9               185        3000 female  2007
41 Adelie  Dream               39.6          18.8               190        4600 male    2007
42 Adelie  Dream               41.1          19                 182        3425 male    2007
43 Adelie  Dream               36            17.9               190        3450 female  2007
44 Adelie  Dream               42.3          21.2               191        4150 male    2007
45 Adelie  Biscoe              39.6          17.7               186        3500 female  2008
46 Adelie  Biscoe              40.1          18.9               188        4300 male    2008
47 Adelie  Biscoe              35            17.9               190        3450 female  2008
48 Adelie  Biscoe              42            19.5               200        4050 male    2008
49 Adelie  Biscoe              34.5          18.1               187        2900 female  2008
50 Adelie  Biscoe              41.4          18.6               191        3700 male    2008
51 Adelie  Biscoe              39            17.5               186        3550 female  2008
52 Adelie  Biscoe              40.6          18.8               193        3800 male    2008
53 Adelie  Biscoe              36.5          16.6               181        2850 female  2008
54 Adelie  Biscoe              37.6          19.1               194        3750 male    2008
55 Adelie  Biscoe              35.7          16.9               185        3150 female  2008
# ℹ 278 more rows
```

```
[1] NA
```
]

---
count: false
 

.panel1-fitted_5-auto[

```r
penguins %&gt;%
* ggplot()

NA
```
]
 
.panel2-fitted_5-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/fitted_5_auto_02_output-1.png)&lt;!-- --&gt;

```
[1] NA
```
]

---
count: false
 

.panel1-fitted_5-auto[

```r
penguins %&gt;%
  ggplot() +
* aes(x = bill_depth_mm, y = bill_length_mm)

NA
```
]
 
.panel2-fitted_5-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/fitted_5_auto_03_output-1.png)&lt;!-- --&gt;

```
[1] NA
```
]

---
count: false
 

.panel1-fitted_5-auto[

```r
penguins %&gt;%
  ggplot() +
  aes(x = bill_depth_mm, y = bill_length_mm) +
* geom_point()

NA
```
]
 
.panel2-fitted_5-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/fitted_5_auto_04_output-1.png)&lt;!-- --&gt;

```
[1] NA
```
]

---
count: false
 

.panel1-fitted_5-auto[

```r
penguins %&gt;%
  ggplot() +
  aes(x = bill_depth_mm, y = bill_length_mm) +
  geom_point() +
* geom_smooth(method = "lm", se = F)

NA
```
]
 
.panel2-fitted_5-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/fitted_5_auto_05_output-1.png)&lt;!-- --&gt;

```
[1] NA
```
]

---
count: false
 

.panel1-fitted_5-auto[

```r
penguins %&gt;%
  ggplot() +
  aes(x = bill_depth_mm, y = bill_length_mm) +
  geom_point() +
  geom_smooth(method = "lm", se = F)+
* geom_point_lm_fitted(color = "blue")

NA
```
]
 
.panel2-fitted_5-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/fitted_5_auto_06_output-1.png)&lt;!-- --&gt;

```
[1] NA
```
]

&lt;style&gt;
.panel1-fitted_5-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-fitted_5-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-fitted_5-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;






---
class: inverse, middle, center


### And check out conditionality

---


count: false
 

.panel1-fitted_6-auto[

```r
*penguins

NA
```
]
 
.panel2-fitted_6-auto[

```
# A tibble: 333 × 8
   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex     year
   &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt; &lt;fct&gt;  &lt;int&gt;
 1 Adelie  Torgersen           39.1          18.7               181        3750 male    2007
 2 Adelie  Torgersen           39.5          17.4               186        3800 female  2007
 3 Adelie  Torgersen           40.3          18                 195        3250 female  2007
 4 Adelie  Torgersen           36.7          19.3               193        3450 female  2007
 5 Adelie  Torgersen           39.3          20.6               190        3650 male    2007
 6 Adelie  Torgersen           38.9          17.8               181        3625 female  2007
 7 Adelie  Torgersen           39.2          19.6               195        4675 male    2007
 8 Adelie  Torgersen           41.1          17.6               182        3200 female  2007
 9 Adelie  Torgersen           38.6          21.2               191        3800 male    2007
10 Adelie  Torgersen           34.6          21.1               198        4400 male    2007
11 Adelie  Torgersen           36.6          17.8               185        3700 female  2007
12 Adelie  Torgersen           38.7          19                 195        3450 female  2007
13 Adelie  Torgersen           42.5          20.7               197        4500 male    2007
14 Adelie  Torgersen           34.4          18.4               184        3325 female  2007
15 Adelie  Torgersen           46            21.5               194        4200 male    2007
16 Adelie  Biscoe              37.8          18.3               174        3400 female  2007
17 Adelie  Biscoe              37.7          18.7               180        3600 male    2007
18 Adelie  Biscoe              35.9          19.2               189        3800 female  2007
19 Adelie  Biscoe              38.2          18.1               185        3950 male    2007
20 Adelie  Biscoe              38.8          17.2               180        3800 male    2007
21 Adelie  Biscoe              35.3          18.9               187        3800 female  2007
22 Adelie  Biscoe              40.6          18.6               183        3550 male    2007
23 Adelie  Biscoe              40.5          17.9               187        3200 female  2007
24 Adelie  Biscoe              37.9          18.6               172        3150 female  2007
25 Adelie  Biscoe              40.5          18.9               180        3950 male    2007
26 Adelie  Dream               39.5          16.7               178        3250 female  2007
27 Adelie  Dream               37.2          18.1               178        3900 male    2007
28 Adelie  Dream               39.5          17.8               188        3300 female  2007
29 Adelie  Dream               40.9          18.9               184        3900 male    2007
30 Adelie  Dream               36.4          17                 195        3325 female  2007
31 Adelie  Dream               39.2          21.1               196        4150 male    2007
32 Adelie  Dream               38.8          20                 190        3950 male    2007
33 Adelie  Dream               42.2          18.5               180        3550 female  2007
34 Adelie  Dream               37.6          19.3               181        3300 female  2007
35 Adelie  Dream               39.8          19.1               184        4650 male    2007
36 Adelie  Dream               36.5          18                 182        3150 female  2007
37 Adelie  Dream               40.8          18.4               195        3900 male    2007
38 Adelie  Dream               36            18.5               186        3100 female  2007
39 Adelie  Dream               44.1          19.7               196        4400 male    2007
40 Adelie  Dream               37            16.9               185        3000 female  2007
41 Adelie  Dream               39.6          18.8               190        4600 male    2007
42 Adelie  Dream               41.1          19                 182        3425 male    2007
43 Adelie  Dream               36            17.9               190        3450 female  2007
44 Adelie  Dream               42.3          21.2               191        4150 male    2007
45 Adelie  Biscoe              39.6          17.7               186        3500 female  2008
46 Adelie  Biscoe              40.1          18.9               188        4300 male    2008
47 Adelie  Biscoe              35            17.9               190        3450 female  2008
48 Adelie  Biscoe              42            19.5               200        4050 male    2008
49 Adelie  Biscoe              34.5          18.1               187        2900 female  2008
50 Adelie  Biscoe              41.4          18.6               191        3700 male    2008
51 Adelie  Biscoe              39            17.5               186        3550 female  2008
52 Adelie  Biscoe              40.6          18.8               193        3800 male    2008
53 Adelie  Biscoe              36.5          16.6               181        2850 female  2008
54 Adelie  Biscoe              37.6          19.1               194        3750 male    2008
55 Adelie  Biscoe              35.7          16.9               185        3150 female  2008
# ℹ 278 more rows
```

```
[1] NA
```
]

---
count: false
 

.panel1-fitted_6-auto[

```r
penguins %&gt;%
* ggplot()

NA
```
]
 
.panel2-fitted_6-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/fitted_6_auto_02_output-1.png)&lt;!-- --&gt;

```
[1] NA
```
]

---
count: false
 

.panel1-fitted_6-auto[

```r
penguins %&gt;%
  ggplot() +
* aes(x = bill_depth_mm,
*     y = bill_length_mm)

NA
```
]
 
.panel2-fitted_6-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/fitted_6_auto_03_output-1.png)&lt;!-- --&gt;

```
[1] NA
```
]

---
count: false
 

.panel1-fitted_6-auto[

```r
penguins %&gt;%
  ggplot() +
  aes(x = bill_depth_mm,
      y = bill_length_mm) +
* geom_point()

NA
```
]
 
.panel2-fitted_6-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/fitted_6_auto_04_output-1.png)&lt;!-- --&gt;

```
[1] NA
```
]

---
count: false
 

.panel1-fitted_6-auto[

```r
penguins %&gt;%
  ggplot() +
  aes(x = bill_depth_mm,
      y = bill_length_mm) +
  geom_point() +
* geom_smooth(method="lm", se= F)

NA
```
]
 
.panel2-fitted_6-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/fitted_6_auto_05_output-1.png)&lt;!-- --&gt;

```
[1] NA
```
]

---
count: false
 

.panel1-fitted_6-auto[

```r
penguins %&gt;%
  ggplot() +
  aes(x = bill_depth_mm,
      y = bill_length_mm) +
  geom_point() +
  geom_smooth(method="lm", se= F) +
* geom_point_lm_fitted()

NA
```
]
 
.panel2-fitted_6-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/fitted_6_auto_06_output-1.png)&lt;!-- --&gt;

```
[1] NA
```
]

---
count: false
 

.panel1-fitted_6-auto[

```r
penguins %&gt;%
  ggplot() +
  aes(x = bill_depth_mm,
      y = bill_length_mm) +
  geom_point() +
  geom_smooth(method="lm", se= F) +
  geom_point_lm_fitted() +
* facet_wrap(facets = vars(species))

NA
```
]
 
.panel2-fitted_6-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/fitted_6_auto_07_output-1.png)&lt;!-- --&gt;

```
[1] NA
```
]

&lt;style&gt;
.panel1-fitted_6-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-fitted_6-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-fitted_6-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;








---
class: inverse, middle, center
background-image: url(https://images.unsplash.com/photo-1499636136210-6f4ee915583e?ixlib=rb-1.2.1&amp;ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&amp;auto=format&amp;fit=crop&amp;w=464&amp;q=80)
background-size: cover


---
class: inverse, middle, center

## Now you... Create the function `geom_segment_lm_residuals()`. 

--

### Hint: read about what aesthetics are required for segments.  We'll give you Step 0 this time...

--

## Step 0: use base ggplot2 to get the job done

---

count: false
 

.panel1-residuals-auto[

```r
*model &lt;- lm(formula =
*             bill_length_mm ~ bill_depth_mm,
*           data = penguins)
```
]
 
.panel2-residuals-auto[

]

---
count: false
 

.panel1-residuals-auto[

```r
model &lt;- lm(formula =
              bill_length_mm ~ bill_depth_mm,
            data = penguins)

*penguins_w_fitted &lt;- penguins
```
]
 
.panel2-residuals-auto[

]

---
count: false
 

.panel1-residuals-auto[

```r
model &lt;- lm(formula =
              bill_length_mm ~ bill_depth_mm,
            data = penguins)

penguins_w_fitted &lt;- penguins %&gt;%
* mutate(fitted = model$fitted.values)
```
]
 
.panel2-residuals-auto[

]

---
count: false
 

.panel1-residuals-auto[

```r
model &lt;- lm(formula =
              bill_length_mm ~ bill_depth_mm,
            data = penguins)

penguins_w_fitted &lt;- penguins %&gt;%
  mutate(fitted = model$fitted.values)

*penguins
```
]
 
.panel2-residuals-auto[

```
# A tibble: 333 × 8
   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex     year
   &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt; &lt;fct&gt;  &lt;int&gt;
 1 Adelie  Torgersen           39.1          18.7               181        3750 male    2007
 2 Adelie  Torgersen           39.5          17.4               186        3800 female  2007
 3 Adelie  Torgersen           40.3          18                 195        3250 female  2007
 4 Adelie  Torgersen           36.7          19.3               193        3450 female  2007
 5 Adelie  Torgersen           39.3          20.6               190        3650 male    2007
 6 Adelie  Torgersen           38.9          17.8               181        3625 female  2007
 7 Adelie  Torgersen           39.2          19.6               195        4675 male    2007
 8 Adelie  Torgersen           41.1          17.6               182        3200 female  2007
 9 Adelie  Torgersen           38.6          21.2               191        3800 male    2007
10 Adelie  Torgersen           34.6          21.1               198        4400 male    2007
11 Adelie  Torgersen           36.6          17.8               185        3700 female  2007
12 Adelie  Torgersen           38.7          19                 195        3450 female  2007
13 Adelie  Torgersen           42.5          20.7               197        4500 male    2007
14 Adelie  Torgersen           34.4          18.4               184        3325 female  2007
15 Adelie  Torgersen           46            21.5               194        4200 male    2007
16 Adelie  Biscoe              37.8          18.3               174        3400 female  2007
17 Adelie  Biscoe              37.7          18.7               180        3600 male    2007
18 Adelie  Biscoe              35.9          19.2               189        3800 female  2007
19 Adelie  Biscoe              38.2          18.1               185        3950 male    2007
20 Adelie  Biscoe              38.8          17.2               180        3800 male    2007
21 Adelie  Biscoe              35.3          18.9               187        3800 female  2007
22 Adelie  Biscoe              40.6          18.6               183        3550 male    2007
23 Adelie  Biscoe              40.5          17.9               187        3200 female  2007
24 Adelie  Biscoe              37.9          18.6               172        3150 female  2007
25 Adelie  Biscoe              40.5          18.9               180        3950 male    2007
26 Adelie  Dream               39.5          16.7               178        3250 female  2007
27 Adelie  Dream               37.2          18.1               178        3900 male    2007
28 Adelie  Dream               39.5          17.8               188        3300 female  2007
29 Adelie  Dream               40.9          18.9               184        3900 male    2007
30 Adelie  Dream               36.4          17                 195        3325 female  2007
31 Adelie  Dream               39.2          21.1               196        4150 male    2007
32 Adelie  Dream               38.8          20                 190        3950 male    2007
33 Adelie  Dream               42.2          18.5               180        3550 female  2007
34 Adelie  Dream               37.6          19.3               181        3300 female  2007
35 Adelie  Dream               39.8          19.1               184        4650 male    2007
36 Adelie  Dream               36.5          18                 182        3150 female  2007
37 Adelie  Dream               40.8          18.4               195        3900 male    2007
38 Adelie  Dream               36            18.5               186        3100 female  2007
39 Adelie  Dream               44.1          19.7               196        4400 male    2007
40 Adelie  Dream               37            16.9               185        3000 female  2007
41 Adelie  Dream               39.6          18.8               190        4600 male    2007
42 Adelie  Dream               41.1          19                 182        3425 male    2007
43 Adelie  Dream               36            17.9               190        3450 female  2007
44 Adelie  Dream               42.3          21.2               191        4150 male    2007
45 Adelie  Biscoe              39.6          17.7               186        3500 female  2008
46 Adelie  Biscoe              40.1          18.9               188        4300 male    2008
47 Adelie  Biscoe              35            17.9               190        3450 female  2008
48 Adelie  Biscoe              42            19.5               200        4050 male    2008
49 Adelie  Biscoe              34.5          18.1               187        2900 female  2008
50 Adelie  Biscoe              41.4          18.6               191        3700 male    2008
51 Adelie  Biscoe              39            17.5               186        3550 female  2008
52 Adelie  Biscoe              40.6          18.8               193        3800 male    2008
53 Adelie  Biscoe              36.5          16.6               181        2850 female  2008
54 Adelie  Biscoe              37.6          19.1               194        3750 male    2008
55 Adelie  Biscoe              35.7          16.9               185        3150 female  2008
# ℹ 278 more rows
```
]

---
count: false
 

.panel1-residuals-auto[

```r
model &lt;- lm(formula =
              bill_length_mm ~ bill_depth_mm,
            data = penguins)

penguins_w_fitted &lt;- penguins %&gt;%
  mutate(fitted = model$fitted.values)

penguins %&gt;%
* ggplot()
```
]
 
.panel2-residuals-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/residuals_auto_05_output-1.png)&lt;!-- --&gt;
]

---
count: false
 

.panel1-residuals-auto[

```r
model &lt;- lm(formula =
              bill_length_mm ~ bill_depth_mm,
            data = penguins)

penguins_w_fitted &lt;- penguins %&gt;%
  mutate(fitted = model$fitted.values)

penguins %&gt;%
  ggplot() +
* aes(x = bill_depth_mm, y = bill_length_mm)
```
]
 
.panel2-residuals-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/residuals_auto_06_output-1.png)&lt;!-- --&gt;
]

---
count: false
 

.panel1-residuals-auto[

```r
model &lt;- lm(formula =
              bill_length_mm ~ bill_depth_mm,
            data = penguins)

penguins_w_fitted &lt;- penguins %&gt;%
  mutate(fitted = model$fitted.values)

penguins %&gt;%
  ggplot() +
  aes(x = bill_depth_mm, y = bill_length_mm) +
* geom_point()
```
]
 
.panel2-residuals-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/residuals_auto_07_output-1.png)&lt;!-- --&gt;
]

---
count: false
 

.panel1-residuals-auto[

```r
model &lt;- lm(formula =
              bill_length_mm ~ bill_depth_mm,
            data = penguins)

penguins_w_fitted &lt;- penguins %&gt;%
  mutate(fitted = model$fitted.values)

penguins %&gt;%
  ggplot() +
  aes(x = bill_depth_mm, y = bill_length_mm) +
  geom_point() +
* geom_smooth(method = "lm", se = F)
```
]
 
.panel2-residuals-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/residuals_auto_08_output-1.png)&lt;!-- --&gt;
]

---
count: false
 

.panel1-residuals-auto[

```r
model &lt;- lm(formula =
              bill_length_mm ~ bill_depth_mm,
            data = penguins)

penguins_w_fitted &lt;- penguins %&gt;%
  mutate(fitted = model$fitted.values)

penguins %&gt;%
  ggplot() +
  aes(x = bill_depth_mm, y = bill_length_mm) +
  geom_point() +
  geom_smooth(method = "lm", se = F) +
* geom_segment(data = penguins_w_fitted,
*            aes(yend = fitted, xend = bill_depth_mm),
*            color = "blue")
```
]
 
.panel2-residuals-auto[
![](easy_geom_recipes_flipbook_2024_files/figure-html/residuals_auto_09_output-1.png)&lt;!-- --&gt;
]

&lt;style&gt;
.panel1-residuals-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-residuals-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-residuals-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;





---
class: inverse, center, middle
background-image: url(https://images.unsplash.com/photo-1630297169944-1316e5e011f8?ixlib=rb-1.2.1&amp;ixid=MnwxMjA3fDB8MHxzZWFyY2h8MTc1fHxiYWtlcnl8ZW58MHx8MHx8&amp;auto=format&amp;fit=crop&amp;w=400&amp;q=60)
background-size: cover


## Not interested in writing your own geoms?  

--

### Check out some ready-to-go geoms that might be of interest in the [{ggxmean}](https://evamaerey.github.io/ggxmean/) package... or [other extension packages](https://exts.ggplot2.tidyverse.org/).


--

## Or interested in working a bit more with geoms and making them available to more folks, but not interested in writing your own package?

--


### Join in on the development and validation of the ggxmean package for statistical educators and everyday analysis.

---



#### Photo Credits: Thalia Ruiz, Jennifer Pallian, Lisa Hanly, John Dancy, Piper Bchamp

#### More comprehensive extension resources: 

- https://www.youtube.com/watch?v=uj7A3i2fi54
- https://cran.r-project.org/web/packages/ggplot2/vignettes/extending-ggplot2.html

- https://ggplot2-book.org/extensions.html
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"ratio": "16:9",
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
