---
title: "another experiment"
author: "Evangeline Reynolds"
date: "`r Sys.Date()`"
output: 
  html_document:
    toc: TRUE
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
options(tidyverse.quiet = TRUE)
```




## Intro Thoughts


## Status Quo

```{r}
library(tidyverse)


levels <- c("very unlikely"  ,      "somewhat unlikely" ,       
            "neither likely nor unlikely",  "somewhat likely",  "very likely")
levels <- levels |> factor(levels)

sample(levels, 20, replace = T)

stress_synthetic_wide <- data.frame(v1 = sample(levels, 500, replace = T),
                                    v2 = sample(levels, 500, replace = T),
                                    v3 = sample(levels, 500, replace = T),
                                    v4 = sample(levels, 500, replace = T),
                                    v5 = sample(levels, 500, replace = T))
                                    

head(stress_synthetic_wide)

set.seed(12345)
stress_synthetic_long <- stress_synthetic_wide |> 
  pivot_longer(cols = everything()) |>
  rename(question = name,
         response = value ) |>
  arrange(question) |>
  mutate(response_collapse = case_when(response |> as.numeric() %in% 1:2 ~ "unlikley",
                                      response |> as.numeric() %in% 4:5  ~ "likely",
                                      response |> as.numeric() == 3 ~ "neither"))


library(ggstats)

stress_synthetic_long |>
  ggplot() + 
  aes(y = question) +
  geom_likert() +
  aes(fill = response)


stress_synthetic_long |>
  ggplot() + 
  aes(y = question) +
  geom_likert(data = . %>% filter(response_collapse != "neither")) +
  aes(fill = response) + 
  geom_likert_text(data = . %>%  filter(response_collapse != "neither"),
                   aes(fill = response_collapse),
                   position_likert(vjust = .5))

# + 
  # geom_bar(data = . %>% filter(response_collapse == "neither"),
           # position = )
geom_likert_text


```

## Experiment

```{r}

```



## Closing remarks, Other Relevant Work, Caveats
